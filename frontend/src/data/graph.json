{
  "nodes": [
    {
      "id": "order-paper",
      "type": "input",
      "label": "紙・FAX",
      "flowType": "order",
      "description": "顧客から届いた紙やFAXの注文書を確認・整理します。",
      "commonMistakes": ["文字の判別ミス", "情報の欠落（納期や場所の確認）"],
      "nextAction": {
        "label": "OCR読み取りへ"
      },
      "order": 1
    },
    {
      "id": "order-ocr",
      "type": "register",
      "label": "OCR",
      "flowType": "order",
      "description": "SmartReadなどのOCRツールを使用して、注文書をデジタルデータに変換します。",
      "commonMistakes": ["読み取りエラーの見落とし", "低解像度による誤変換"],
      "nextAction": {
        "label": "OCR結果確認へ"
      },
      "order": 2
    },
    {
      "id": "order-ocr-result",
      "type": "confirm",
      "label": "OCR結果(ロット引当)",
      "flowType": "order",
      "description": "OCR結果を確認し、ロットを引き当てます。先方品番＋次区をキーにロット管理表からロット番号を発番し、引当を行います。",
      "commonMistakes": ["先方品番のマッピング間違い", "次区（配送ルート）の不一致"],
      "nextAction": {
        "label": "SAP連携へ"
      },
      "order": 3
    },
    {
      "id": "order-sap",
      "type": "register",
      "label": "SAP連携",
      "flowType": "order",
      "description": "確定した注文データと引当情報をSAP（基幹システム）に送信し、正式な受注として登録します。",
      "commonMistakes": ["API送信エラー", "マスタデータの同期不備"],
      "relatedExceptions": ["SAP登録失敗対応"],
      "order": 4
    },
    {
      "id": "alloc-detail",
      "type": "confirm",
      "label": "引当詳細",
      "flowType": "allocation",
      "description": "引当済みの在庫詳細を確認します。倉庫別の割り当てや、特定のロット情報の確認を行います。",
      "commonMistakes": ["ロットの有効期限切れ見落とし", "倉庫の間違い"],
      "relatedExceptions": ["在庫不足対応"],
      "order": 5
    }
  ],
  "edges": [
    {
      "id": "e1",
      "source": "order-paper",
      "target": "order-ocr",
      "label": "読み取り"
    },
    {
      "id": "e2",
      "source": "order-ocr",
      "target": "order-ocr-result",
      "label": "データ化"
    },
    {
      "id": "e3",
      "source": "order-ocr-result",
      "target": "order-sap",
      "label": "確定"
    },
    {
      "id": "e4",
      "source": "order-sap",
      "target": "alloc-detail",
      "label": "引当確認へ"
    }
  ],
  "exceptions": [
    {
      "id": "ex-stock-shortage",
      "title": "在庫不足",
      "description": "引当時に在庫が足りない場合の対応",
      "trigger": "OCR結果確認時に「在庫不足」の警告が出た場合",
      "steps": ["不足数量を確認", "入荷予定を確認", "担当者に連絡", "顧客への納期回答を調整"]
    },
    {
      "id": "ex-sap-failed",
      "title": "SAP登録失敗",
      "description": "SAPへのデータ送信でエラーが発生した場合",
      "trigger": "SAP連携時にエラーメッセージが表示された場合",
      "steps": [
        "エラーログから原因（マスタ未登録など）を特定",
        "マスタを修正し、再送信を実行",
        "解消しない場合はシステム管理者に連絡"
      ]
    }
  ],
  "terms": [
    {
      "term": "ロット引当",
      "definition": "注文に対して特定の製造ロットを予約すること。先方品番と次区コードを用いて最適なロットが選択されます。",
      "relatedNodes": ["order-ocr-result"]
    },
    {
      "term": "次区",
      "definition": "配送先や配送ルートを特定するためのコード。ロットの選定においても重要なキーとなります。",
      "relatedNodes": ["order-ocr-result"]
    }
  ]
}
