# 現在のタスク一覧

**最終更新:** 2025-12-11

> **このドキュメントの目的**: 
> - **未対応**または**進行中**のタスクのみを記載
> - **完了したタスク**は`CHANGELOG.md`に記録され、このファイルからは削除される
> - 常に「今やるべきこと」だけが載っている状態を維持

---

## 🚧 残タスク（P1: 高優先度）

### P1-1: オリジナル（需要予測）→ 仮受注の自動連動

**ステータス:** 未着手

**現状の問題:**
1. 日別指示に数値を入力しても「計画引当サマリ」が更新されない
2. 「自動引当」ボタンが2箇所（右上 + 関連受注セクション）にあり冗長

**要望:**
1. **日別指示 → 計画引当サマリの自動再計算**
   - 日別指示を入力/変更したら、計画引当サマリが即座に再計算される
2. **関連受注セクションの自動引当ボタンを削除**
   - 自動引当は右上の1箇所のみに統一
3. **日別指示 → 仮受注の自動作成**
   - 日別指示を入力すると、その日に対応する「仮受注」が自動生成される
   - この仮受注は先行登録のため（その日に来るはずの受注を先取り）
4. **日別指示削除 → 仮受注の自動削除**
   - 日別指示を削除すると、対応する仮受注も連動して削除される

**修正対象:**
- `frontend/src/features/forecasts/` - フォーキャスト関連コンポーネント
- `backend/app/` - 仮受注自動生成ロジック

---

### P1-2: 納入先マスタ作成（優先）

**ステータス:** 完了（要確認事項あり）

**完了:**
- ✅ バックエンドCRUD API
- ✅ フロントエンド一覧/新規/編集/削除ダイアログ
- ✅ ルーティング、マスタページリンク追加
- ✅ 得意先IDの隣に得意先名も表示
- ✅ フロントエンドで`jiku_code`をnull→空文字に変換して送信

**要確認事項:**
- ⚠️ DBレベルでは `jiku_code` は `nullable=True` のまま
- ⚠️ バックエンドで空文字→nullに変換されていないか確認が必要

---

### P1-3: 商品マスタ管理ページ作成

**ステータス:** 完了

**完了:**
- ✅ `/products`（製品マスタ）→ 表示名「製品マスタ」に変更
- ✅ `product_mappings` → 新規「商品マスタ」ページ作成（`/product-mappings`）
- ✅ バックエンドCRUD API（`product_mappings_router.py`）
- ✅ フロントエンド一覧/新規/編集/削除ダイアログ

---

### P1-4: マスタページ操作・レイアウトの統一

**ステータス:** 一部完了（残タスクあり）

**完了:**
- ✅ レイアウト統一（`space-y-6 px-6 py-6 md:px-8`）
- ✅ 一覧画面に編集・削除ボタン追加（得意先/倉庫/製品/仕入先）

**残タスク- [ ] P1-4: レイアウト・操作統一
    - [x] 単位換算: 新規登録ボタン追加、ダイアログ実装
    - [x] 仕入先商品: 新規・編集・削除機能、一覧表示、インポート
    - [ ] その他: 既存画面のUI統一（必要に応じて）（バックエンドCRUD APIが必要）

**要確認事項:**
- ⚠️ **現在の削除は物理削除**（`db.delete(instance)`）
- ⚠️ 論理削除に変更する場合は `is_active` フラグを使用するパターンに変更が必要

---

### P1-5: 一括インポート・初期化ロジック更新

**ステータス:** 未着手

**問題:**
現在のテーブル構成と一括インポートのロジックが合っていない可能性がある。

**確認事項:**
- `delivery_places`, `product_mappings` 等新規テーブルのインポート対応
- 既存インポート形式との整合性確認

---

## 📌 将来対応（P2: 中優先度）

### P2-2: フォーキャスト編集後の画面更新問題

**ステータス:** 保留（優先度: 低）

手動リフレッシュで回避可能。バックエンド調査が必要な可能性あり。

詳細: [`docs/tasks/forecast-update-issue.md`](forecast-update-issue.md)

---

### P2-3: SAP在庫同期 - 本番API接続待ち

**現状**: モック実装完了、UI実装完了

**残タスク**（本番SAP接続が必要）:
- ❌ 本番SAP API接続
- ❌ 定期実行設定（オプション）

---

## 📌 将来対応（P3: 低優先度）

### P3-1: SAP受注登録の本番化

**現状:** モック実装済み、本番SAP API接続待ち

---

## 📊 コード品質

| 種類 | 件数 | 状態 |
|------|------|------|
| **ESLint Errors** | 0 | ✅ Clean |
| **TS Errors** | 0 | ✅ Clean |
| **Mypy Errors** | 0 | ✅ Clean |
| **Ruff Errors** | 0 | ✅ Clean |
| **Backend Tests** | 321 passed | ✅ Clean |

---

## 参照

- **変更履歴:** [`CHANGELOG.md`](../CHANGELOG.md)
- **完了機能:** [`docs/COMPLETED_FEATURES.adoc`](COMPLETED_FEATURES.adoc)
- **開発ガイド:** [`CLAUDE.md`](../CLAUDE.md)
