# API Reference - Lot Management System

**æœ€çµ‚æ›´æ–°**: 2025-11-26
**API ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v2.2.1
**ãƒ™ãƒ¼ã‚¹URL**: `/api`

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€ãƒ­ãƒƒãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…æ¸ˆã¿ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§ã§ã™ã€‚è©³ç´°ãªä»•æ§˜ã¯ [OpenAPI ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](http://localhost:8000/api/docs) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

## ğŸ“‹ ç›®æ¬¡

1. [Masters API](#masters-api) - ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†
2. [Orders API](#orders-api) - å—æ³¨ç®¡ç†
3. [Allocations API](#allocations-api) - å¼•å½“ç®¡ç†
4. [Forecasts API](#forecasts-api) - ãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆç®¡ç†
5. [Inventory API](#inventory-api) - åœ¨åº«ç®¡ç†
6. [Alerts API](#alerts-api) - ã‚¢ãƒ©ãƒ¼ãƒˆç®¡ç†
7. [Admin & System API](#admin--system-api) - ç®¡ç†ãƒ»é‹ç”¨ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼

---

## Masters API

ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã®å‚ç…§ãƒ»ç™»éŒ²ãƒ»æ›´æ–°ã‚’è¡Œã„ã¾ã™ã€‚

**ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹**: `/api` (å„ãƒªã‚½ãƒ¼ã‚¹ç›´ä¸‹)

| ãƒªã‚½ãƒ¼ã‚¹ | ãƒ¡ã‚½ãƒƒãƒ‰ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | èª¬æ˜ |
|---------|---------|--------------|------|
| **Warehouses** | `GET` | `/warehouses` | å€‰åº«ä¸€è¦§å–å¾— |
| | `POST` | `/warehouses` | å€‰åº«ç™»éŒ² |
| | `GET` | `/warehouses/{id}` | å€‰åº«è©³ç´°å–å¾— |
| | `PUT` | `/warehouses/{id}` | å€‰åº«æ›´æ–° |
| **Suppliers** | `GET` | `/suppliers` | ä»•å…¥å…ˆä¸€è¦§å–å¾— |
| | `POST` | `/suppliers` | ä»•å…¥å…ˆç™»éŒ² |
| | `GET` | `/suppliers/{id}` | ä»•å…¥å…ˆè©³ç´°å–å¾— |
| | `PUT` | `/suppliers/{id}` | ä»•å…¥å…ˆæ›´æ–° |
| **Customers** | `GET` | `/customers` | å¾—æ„å…ˆä¸€è¦§å–å¾— |
| | `POST` | `/customers` | å¾—æ„å…ˆç™»éŒ² |
| | `GET` | `/customers/{id}` | å¾—æ„å…ˆè©³ç´°å–å¾— |
| | `PUT` | `/customers/{id}` | å¾—æ„å…ˆæ›´æ–° |
| **Products** | `GET` | `/products` | è£½å“ä¸€è¦§å–å¾— |
| | `POST` | `/products` | è£½å“ç™»éŒ² |
| | `GET` | `/products/{id}` | è£½å“è©³ç´°å–å¾— |
| | `PUT` | `/products/{id}` | è£½å“æ›´æ–° |
| **Customer Items** | `GET` | `/customer-items` | å“ç•ªãƒãƒƒãƒ”ãƒ³ã‚°ä¸€è¦§å–å¾— |
| | `POST` | `/customer-items` | å“ç•ªãƒãƒƒãƒ”ãƒ³ã‚°ç™»éŒ² |
| | `GET` | `/customer-items/{customer_id}` | ç‰¹å®šå¾—æ„å…ˆã®å“ç•ªä¸€è¦§ |
| | `DELETE` | `/customer-items/{customer_id}/{product_id}` | å“ç•ªãƒãƒƒãƒ”ãƒ³ã‚°å‰Šé™¤ |

---

## Orders API

å—æ³¨æƒ…å ±ã®ç®¡ç†ã‚’è¡Œã„ã¾ã™ã€‚

**ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹**: `/api/orders`

| ãƒ¡ã‚½ãƒƒãƒ‰ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | èª¬æ˜ |
|---------|--------------|------|
| `GET` | `/orders` | å—æ³¨ä¸€è¦§å–å¾— |
| `POST` | `/orders` | å—æ³¨ä½œæˆ |
| `GET` | `/orders/{id}` | å—æ³¨è©³ç´°å–å¾— |
| `PATCH` | `/orders/{id}/status` | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–° |
| `DELETE` | `/orders/{id}` | å—æ³¨å‰Šé™¤ï¼ˆã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼‰ |

---

## Allocations API

åœ¨åº«å¼•å½“ã®è¨ˆç®—ã€ææ¡ˆã€ç¢ºå®šã‚’è¡Œã„ã¾ã™ã€‚

**ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹**: `/api`

| ã‚«ãƒ†ã‚´ãƒª | ãƒ¡ã‚½ãƒƒãƒ‰ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | èª¬æ˜ |
|---------|---------|--------------|------|
| **Allocations** | `POST` | `/allocations/commit` | å¼•å½“ç¢ºå®š |
| | `DELETE` | `/allocations/{id}` | å¼•å½“å–æ¶ˆ |
| **Suggestions** | `GET` | `/allocation-suggestions` | å¼•å½“æ¨å¥¨ä¸€è¦§å–å¾— |
| | `POST` | `/allocation-suggestions/manual` | æ‰‹å‹•å¼•å½“ç™»éŒ² |
| | `POST` | `/allocation-suggestions/fefo` | FEFOå¼•å½“ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ |
| **Candidates** | `GET` | `/allocation-candidates` | å€™è£œãƒ­ãƒƒãƒˆä¸€è¦§å–å¾— |
| **Warehouse** | `GET` | `/warehouse-allocations` | å€‰åº«åˆ¥å¼•å½“çŠ¶æ³å–å¾— |

---

## Forecasts API

ãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆï¼ˆéœ€è¦äºˆæ¸¬ï¼‰ã®ç®¡ç†ã‚’è¡Œã„ã¾ã™ã€‚

**ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹**: `/api/forecasts`

| ãƒ¡ã‚½ãƒƒãƒ‰ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | èª¬æ˜ |
|---------|--------------|------|
| `GET` | `/forecasts/headers` | ãƒ˜ãƒƒãƒ€ä¸€è¦§å–å¾— |
| `POST` | `/forecasts/headers` | ãƒ˜ãƒƒãƒ€ä½œæˆ |
| `GET` | `/forecasts/headers/{id}` | ãƒ˜ãƒƒãƒ€è©³ç´°å–å¾— |
| `PUT` | `/forecasts/headers/{id}` | ãƒ˜ãƒƒãƒ€æ›´æ–° |
| `DELETE` | `/forecasts/headers/{id}` | ãƒ˜ãƒƒãƒ€å‰Šé™¤ |
| `GET` | `/forecasts/headers/{id}/lines` | æ˜ç´°ä¸€è¦§å–å¾— |
| `POST` | `/forecasts/headers/{id}/lines` | æ˜ç´°è¿½åŠ  |
| `PUT` | `/forecasts/lines/{id}` | æ˜ç´°æ›´æ–° |
| `DELETE` | `/forecasts/lines/{id}` | æ˜ç´°å‰Šé™¤ |
| `POST` | `/forecasts/headers/bulk-import` | ä¸€æ‹¬ã‚¤ãƒ³ãƒãƒ¼ãƒˆ |

---

## Inventory API

åœ¨åº«ã€å…¥è·äºˆå®šã€åœ¨åº«èª¿æ•´ã®ç®¡ç†ã‚’è¡Œã„ã¾ã™ã€‚

**ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹**: `/api`

| ã‚«ãƒ†ã‚´ãƒª | ãƒ¡ã‚½ãƒƒãƒ‰ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | èª¬æ˜ |
|---------|---------|--------------|------|
| **Lots** | `GET` | `/lots` | ãƒ­ãƒƒãƒˆä¸€è¦§å–å¾— |
| | `POST` | `/lots` | ãƒ­ãƒƒãƒˆç™»éŒ² |
| | `GET` | `/lots/{id}` | ãƒ­ãƒƒãƒˆè©³ç´°å–å¾— |
| | `PUT` | `/lots/{id}` | ãƒ­ãƒƒãƒˆæ›´æ–° |
| | `DELETE` | `/lots/{id}` | ãƒ­ãƒƒãƒˆå‰Šé™¤ |
| **Inventory Items** | `GET` | `/inventory-items` | åœ¨åº«ã‚µãƒãƒªä¸€è¦§å–å¾— |
| | `GET` | `/inventory-items/{product_id}/{warehouse_id}` | åœ¨åº«ã‚µãƒãƒªè©³ç´°å–å¾— |
| **Inbound Plans** | `GET` | `/inbound-plans` | å…¥è·äºˆå®šä¸€è¦§å–å¾— |
| | `POST` | `/inbound-plans` | å…¥è·äºˆå®šç™»éŒ² |
| | `GET` | `/inbound-plans/{id}` | å…¥è·äºˆå®šè©³ç´°å–å¾— |
| | `PUT` | `/inbound-plans/{id}` | å…¥è·äºˆå®šæ›´æ–° |
| | `DELETE` | `/inbound-plans/{id}` | å…¥è·äºˆå®šå‰Šé™¤ |
| | `GET` | `/inbound-plans/{id}/lines` | å…¥è·äºˆå®šæ˜ç´°ä¸€è¦§å–å¾— |
| | `POST` | `/inbound-plans/{id}/lines` | å…¥è·äºˆå®šæ˜ç´°è¿½åŠ  |
| | `POST` | `/inbound-plans/{id}/receive` | å…¥è·å®Ÿç¸¾ç™»éŒ² |
| **Adjustments** | `GET` | `/adjustments` | åœ¨åº«èª¿æ•´å±¥æ­´å–å¾— |
| | `POST` | `/adjustments` | åœ¨åº«èª¿æ•´ç™»éŒ² |
| | `GET` | `/adjustments/{id}` | åœ¨åº«èª¿æ•´è©³ç´°å–å¾— |

---

## Alerts API

ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆã®ç®¡ç†ã‚’è¡Œã„ã¾ã™ã€‚

**ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹**: `/api/alerts`

| ãƒ¡ã‚½ãƒƒãƒ‰ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | èª¬æ˜ |
|---------|--------------|------|
| `GET` | `/alerts` | ã‚¢ãƒ©ãƒ¼ãƒˆä¸€è¦§å–å¾— |
| `POST` | `/alerts` | ã‚¢ãƒ©ãƒ¼ãƒˆä½œæˆ |
| `GET` | `/alerts/{id}` | ã‚¢ãƒ©ãƒ¼ãƒˆè©³ç´°å–å¾— |
| `PUT` | `/alerts/{id}` | ã‚¢ãƒ©ãƒ¼ãƒˆæ›´æ–° |
| `DELETE` | `/alerts/{id}` | ã‚¢ãƒ©ãƒ¼ãƒˆå‰Šé™¤ |

---

## Admin & System API

ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã€ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã€ãƒ­ã‚°ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç­‰ã®ç®¡ç†æ©Ÿèƒ½ã§ã™ã€‚

**ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹**: `/api`

| ã‚«ãƒ†ã‚´ãƒª | ãƒ¡ã‚½ãƒƒãƒ‰ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | èª¬æ˜ |
|---------|---------|--------------|------|
| **Users** | `GET` | `/users` | ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾— |
| | `POST` | `/users` | ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ |
| | `GET` | `/users/{id}` | ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°å–å¾— |
| | `PUT` | `/users/{id}` | ãƒ¦ãƒ¼ã‚¶ãƒ¼æ›´æ–° |
| | `DELETE` | `/users/{id}` | ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤ |
| | `PATCH` | `/users/{id}/roles` | ãƒ­ãƒ¼ãƒ«å‰²å½“ |
| **Roles** | `GET` | `/roles` | ãƒ­ãƒ¼ãƒ«ä¸€è¦§å–å¾— |
| | `POST` | `/roles` | ãƒ­ãƒ¼ãƒ«ä½œæˆ |
| | `GET` | `/roles/{id}` | ãƒ­ãƒ¼ãƒ«è©³ç´°å–å¾— |
| | `PUT` | `/roles/{id}` | ãƒ­ãƒ¼ãƒ«æ›´æ–° |
| **Operation Logs** | `GET` | `/operation-logs` | æ“ä½œãƒ­ã‚°ä¸€è¦§å–å¾— |
| | `GET` | `/operation-logs/{id}` | æ“ä½œãƒ­ã‚°è©³ç´°å–å¾— |
| **Business Rules** | `GET` | `/business-rules` | æ¥­å‹™ãƒ«ãƒ¼ãƒ«ä¸€è¦§å–å¾— |
| | `GET` | `/business-rules/{code}` | æ¥­å‹™ãƒ«ãƒ¼ãƒ«è©³ç´°å–å¾— |
| | `PUT` | `/business-rules/{code}` | æ¥­å‹™ãƒ«ãƒ¼ãƒ«æ›´æ–° |
| **Batch Jobs** | `GET` | `/batch-jobs` | ãƒãƒƒãƒã‚¸ãƒ§ãƒ–ä¸€è¦§å–å¾— |
| | `GET` | `/batch-jobs/{id}` | ãƒãƒƒãƒã‚¸ãƒ§ãƒ–è©³ç´°å–å¾— |
| | `POST` | `/batch-jobs/{id}/execute` | ãƒãƒƒãƒã‚¸ãƒ§ãƒ–å®Ÿè¡Œ |
| **Health** | `GET` | `/health` | ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ |
| | `GET` | `/admin/healthcheck` | ç®¡ç†è€…ç”¨ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ |
| **Simulation** | `POST` | `/admin/simulate/day-forward` | æ—¥ä»˜é€²è¡Œã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ |
| | `POST` | `/admin/simulate/reset` | ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒªã‚»ãƒƒãƒˆ |
| **Test Data** | `POST` | `/admin/test-data/generate` | ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ |
| | `POST` | `/admin/test-data/reset` | ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆ |

---

## å…±é€šä»•æ§˜

### ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³

å¤šãã®ä¸€è¦§å–å¾—APIã¯ã€ä»¥ä¸‹ã®ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ï¼š

- `skip` (INT, default: 0) - ã‚¹ã‚­ãƒƒãƒ—ä»¶æ•°
- `limit` (INT, default: 100, max: 1000) - å–å¾—ä»¶æ•°ä¸Šé™

### ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
{
  "detail": "Error message here"
}
```

HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ï¼š
- `200` - æˆåŠŸ
- `201` - ä½œæˆæˆåŠŸ
- `204` - å‰Šé™¤æˆåŠŸï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ãªã—ï¼‰
- `400` - ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼
- `404` - ãƒªã‚½ãƒ¼ã‚¹ãŒè¦‹ã¤ã‹ã‚‰ãªã„
- `409` - ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆï¼ˆå¼•å½“ã‚¨ãƒ©ãƒ¼ç­‰ï¼‰
- `500` - ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼

---

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [OpenAPI ä»•æ§˜ï¼ˆSwagger UIï¼‰](http://localhost:8000/api/docs)
- [Database Schema](./schema/current/db_schema.sql)
