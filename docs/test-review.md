# テストレビュー結果（ロット周りは別ブランチ反映待ち）

## 前提
- ロット／ビュー関連の修正が別ブランチで進行中のため、**ロット依存のテスト追加は保留**。
- ここでは、ロット以外で「不足している観点」を整理し、**優先度の高いものから追加対象**を明確化する。

## 現状把握（サマリ）
- **Backend**
  - API/サービス/インフラ/一部ユニットテストが存在。
  - ただし **skip/xfail が残っている領域**があり、コア機能の回帰検知が不十分。
- **Frontend**
  - Vitestベースのコンポーネント/ユニットテストは多い。
  - PlaywrightのE2Eは存在するが、**APIモック中心で統合性が弱い**。

## 不足観点（ロットを除いた重点領域）
### 1. スキップ／xfailの解消（最優先）
- 「テストがあるが実行されない」領域は、回帰検知に効かないためリスクが高い。
- 割当・バリデーション・数量計算などが該当。

### 2. 実API連携を伴うE2E（高優先）
- UI確認に留まり、**実APIとDBの結合を担保するE2Eが不足**。
- 認可・権限チェックなど、**フロント〜バックエンドの結合シナリオ**を追加する。

### 3. 異常系の仕様固定（高優先）
- 400/409/422 などの返却仕様がプロダクトの安定性に直結。
- **正常系だけだとリグレッションが漏れる**ため、異常系を体系的に拡充。

### 4. 外部連携／帳票入出力の精度確認（中優先）
- ダウンロードの発火だけではなく、**出力データの形式や内容**の確認が必要。

## 追加テストの優先順位（ロット以外）
### P0: 直ちに対応すべき
1. **skip/xfail を解消して動く状態にする**
   - “存在するが動いていないテスト”は最も危険度が高い。

### P1: 早期に追加
2. **実API連携のE2Eを最低限追加**
   - 認証・権限付きの主要画面（受注、在庫、出荷など）
3. **異常系テストの拡充**
   - バリデーション・重複・競合（409等）をAPI/サービスで固定

### P2: 中期的に追加
4. **出力帳票の中身検証**
   - Excel/CSVの列/値/集計ロジック検証

## 次のアクション候補（ロット以外）
- RPAステップの状態遷移や設定値解決など、**DBビュー非依存のサービス層**を優先してテスト追加。
- 例: RPAのステータス更新、外部連携の設定値解決など。
