# ã‚¿ã‚¹ã‚¯ãƒãƒƒã‚¯ãƒ­ã‚° (çµ±åˆç‰ˆ)

**æœ€çµ‚æ›´æ–°:** 2026-02-05

---

## æ¦‚è¦

æœ¬ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€æœªå®Œäº†ã®ã‚¿ã‚¹ã‚¯ãƒ»èª¿æŸ»äº‹é …ãƒ»å°†æ¥æ”¹å–„é …ç›®ã‚’é›†ç´„ã—ãŸãƒãƒƒã‚¯ãƒ­ã‚°ã§ã™ã€‚å®Œäº†æ¸ˆã¿ã®ã‚¿ã‚¹ã‚¯ã¯åˆ¥é€”æ®‹ã•ãšã€æœ¬ãƒãƒƒã‚¯ãƒ­ã‚°ã«æœ€æ–°ã®çŠ¶æ…‹ã®ã¿ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚

---

## 1. å„ªå…ˆåº¦: é«˜ (å³æ™‚å¯¾å¿œ)

### 1-0. Phase 4-A: SmartReadãƒ‡ãƒ¼ã‚¿ã®æ¥½è¦³çš„ãƒ­ãƒƒã‚¯å°å…¥

**å„ªå…ˆåº¦:** é«˜ï¼ˆæœ€å„ªå…ˆã‚¿ã‚¹ã‚¯ï¼‰
**ä½œæˆ:** 2025-02-05
**ã‚«ãƒ†ã‚´ãƒª:** æ’ä»–åˆ¶å¾¡ãƒ»ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§
**å·¥æ•°:** 2-3æ—¥

**èƒŒæ™¯:**
Phase 4ã®èª¿æŸ»ã«ã‚ˆã‚Šã€SmartReadã®OCRç·¨é›†æ©Ÿèƒ½ã§**é«˜ãƒªã‚¹ã‚¯ã®ç«¶åˆå•é¡Œ**ãŒåˆ¤æ˜ã€‚è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåŒæ™‚ã«ç·¨é›†ã—ãŸå ´åˆã€ä¸€æ–¹ã®å¤‰æ›´ãŒä¸Šæ›¸ãã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚

**å•é¡Œ:**
- `smartread_wide_data` / `smartread_long_data` ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãªã—
- å…¨è¡Œä¸€æ‹¬ä¿å­˜ã«ã‚ˆã‚Šã€ä»–ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å¤‰æ›´ãŒæ¶ˆå¤±ã™ã‚‹ãƒªã‚¹ã‚¯
- ç¾åœ¨ã®ä¿è­·æ©Ÿæ§‹: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ¬ãƒ™ãƒ«ã®ã¿ï¼ˆä¸ååˆ†ï¼‰

**å®Ÿè£…å†…å®¹:**
1. **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³:** `version` ã‚«ãƒ©ãƒ è¿½åŠ ï¼ˆINTEGER, DEFAULT 1ï¼‰
2. **ãƒ¢ãƒ‡ãƒ«æ›´æ–°:** ORM ã« version ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 
3. **APIå¤‰æ›´:**
   - èª­å–æ™‚ã« version ã‚’å«ã‚ã‚‹
   - æ›´æ–°æ™‚ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯
   - ç«¶åˆæ™‚ã¯ 409 Conflict ã‚’è¿”ã™
4. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°:**
   ```python
   if record.version != request.version:
       raise HTTPException(
           status_code=409,
           detail={
               "error": "OPTIMISTIC_LOCK_CONFLICT",
               "current_version": record.version,
               "expected_version": request.version,
               "message": "Data was modified by another user"
           }
       )
   ```
5. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰:**
   - version ç®¡ç†ãƒ»ä¿æŒ
   - ç«¶åˆæ™‚ã®ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
   - ãƒªãƒ­ãƒ¼ãƒ‰ãƒ»ãƒªãƒˆãƒ©ã‚¤ UI

**æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ:**
- è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åŒæ™‚ç·¨é›†æ™‚ã®ç«¶åˆæ¤œå‡º
- ãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±ã®é˜²æ­¢
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®æ˜ç¢ºãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

**é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ:**
- `docs/project/PHASE4_CONCURRENCY_CONTROL_INVESTIGATION.md` - è©³ç´°èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ

**å…ƒ:** Phase 4èª¿æŸ»çµæœï¼ˆ2025-02-05ï¼‰

---


### 1-1. FastAPI + Vite ãƒ†ã‚¹ãƒˆç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè£…

**å„ªå…ˆåº¦:** é«˜ï¼ˆæ¬¡å„ªå…ˆã‚¿ã‚¹ã‚¯ï¼‰
**ä½œæˆ:** 2026-02-02
**ã‚«ãƒ†ã‚´ãƒª:** ã‚¤ãƒ³ãƒ•ãƒ©ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤

**èƒŒæ™¯:**
æ–°è¦è¿½åŠ ã•ã‚ŒãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ `docs/fastapi_vite_test_deploy_design.md` ã«åŸºã¥ãã€ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ã®ãƒ‡ãƒ—ãƒ­ã‚¤é‹ç”¨ã‚’å®Ÿè£…ã™ã‚‹ã€‚

**ã‚¿ã‚¹ã‚¯å†…å®¹:**
1. `C:\app\` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã®ä½œæˆ
2. `config.json` ã®ä½œæˆ
3. `start_server.py` / `stop_server.py` ã®å®Ÿè£…ï¼ˆPIDç®¡ç†ï¼‰
4. `start_server.bat` / `stop_server.bat` / `restart_server.bat` ã®ä½œæˆ
5. ãƒ­ã‚°æ©Ÿæ§‹ã®å®Ÿè£… (`server_control.log`)
6. zip ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †ã®ç¢ºç«‹
7. å‹•ä½œç¢ºèªãƒ»é‹ç”¨ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ä½œæˆ

**æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ:**
- ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ã®å†èµ·å‹•ä½œæ¥­ãŒãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯1å›ã§å®Œçµ
- å®‰å…¨ãªãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†ï¼ˆPID + ãƒãƒ¼ãƒˆãƒã‚§ãƒƒã‚¯ï¼‰
- ã‚·ãƒ³ãƒ—ãƒ«ãªé‹ç”¨ãƒ•ãƒ­ãƒ¼

**é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ:**
- `docs/fastapi_vite_test_deploy_design.md`

---

### 1-2. é–‹ç™ºç’°å¢ƒã®çµ±ä¸€ã¨æ”¹å–„ (Critical - DXæ”¹å–„)

**å„ªå…ˆåº¦:** é«˜ï¼ˆæ¬¡å›PRæ™‚ã«å¯¾å¿œï¼‰

**ç¾çŠ¶ã®å•é¡Œ:**
- `typegen`ï¼ˆOpenAPIã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰TypeScriptå‹ç”Ÿæˆï¼‰ã¨`ruff`ï¼ˆPythonãƒªãƒ³ã‚¿ãƒ¼ï¼‰ã®å®Ÿè¡Œç’°å¢ƒãŒçµ±ä¸€ã•ã‚Œã¦ã„ãªã„
- Dockerå†…ã§å®Ÿè¡Œã™ã¹ãã‹ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œã™ã¹ãã‹æ›–æ˜§
- ç’°å¢ƒå¤‰æ•°ï¼ˆ`VITE_BACKEND_ORIGIN` vs `BACKEND_ORIGIN`ï¼‰ã®æ··ä¹±
- é–‹ç™ºä¸­ã«Dockerã¨ãƒ­ãƒ¼ã‚«ãƒ«ã‚’è¡Œãæ¥ã™ã‚‹éåŠ¹ç‡ãªä½œæ¥­ãƒ•ãƒ­ãƒ¼

**å¯¾å¿œæ–¹é‡:**
1. **ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œç’°å¢ƒã®æ˜ç¢ºåŒ–:**
   - `npm run typegen`: **ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œã‚’æ¨å¥¨**ï¼ˆ`backend/openapi.json`ã‚’ãƒ›ã‚¹ãƒˆã§å…±æœ‰ï¼‰
   - `ruff check/format`: **Dockerå†…ã§å®Ÿè¡Œ**ï¼ˆ`.git/hooks/pre-commit`ã§è‡ªå‹•åŒ–æ¸ˆã¿ï¼‰
   - å®Ÿè¡Œå ´æ‰€ã‚’`package.json`/`README.md`ã«æ˜è¨˜

2. **OpenAPIã‚¹ã‚­ãƒ¼ãƒç”Ÿæˆã®è‡ªå‹•åŒ–:**
   - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰èµ·å‹•æ™‚ã«`openapi.json`ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ 
   - ã¾ãŸã¯ã€`make typegen`ã‚³ãƒãƒ³ãƒ‰ã§ãƒ¯ãƒ³ã‚¹ãƒ†ãƒƒãƒ—ã§å®Ÿè¡Œå¯èƒ½ã«

3. **ç’°å¢ƒå¤‰æ•°ã®æ•´ç†:**
   - âœ… å®Œäº†: `VITE_BACKEND_ORIGIN` â†’ `BACKEND_ORIGIN`ã«å¤‰æ›´æ¸ˆã¿
   - Docker Composeã®ç’°å¢ƒå¤‰æ•°ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¦ç”¨é€”ã‚’æ˜ç¢ºåŒ–

4. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™:**
   - `docs/development/SETUP.md`ã«é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ã‚’è¿½åŠ 
   - å„ãƒ„ãƒ¼ãƒ«ã®å®Ÿè¡Œç’°å¢ƒï¼ˆDocker/ãƒ­ãƒ¼ã‚«ãƒ«ï¼‰ã‚’æ˜è¨˜

**æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ:**
- é–‹ç™ºè€…ãŒè¿·ã‚ãšã«ãƒ„ãƒ¼ãƒ«ã‚’å®Ÿè¡Œã§ãã‚‹
- CI/CDã¨ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã®ä¸€è²«æ€§å‘ä¸Š
- onboardingæ™‚é–“ã®çŸ­ç¸®

---

### 1-4. E2Eãƒ†ã‚¹ãƒˆæ®‹å­˜å•é¡Œãƒ»ä¸å®‰å®šæ€§

**ç¾çŠ¶:** P0ãƒ†ã‚¹ãƒˆã¯ **32 passed, 6 skipped** ã§å®‰å®šç¨¼åƒã€‚ä¸¦åˆ—å®Ÿè¡Œ (workers=4) ã‚‚æ­£å¸¸ã«å‹•ä½œã™ã‚‹ã€‚

**æ®‹å­˜å•é¡Œï¼ˆ2ä»¶ - ä½å„ªå…ˆåº¦ï¼‰:**

1. **ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”ŸæˆãŒ warehouse/product ã‚’ä½œæˆã—ãªã„**
   - å½±éŸ¿: e2e-02-save-persistence.spec.ts ã®2ãƒ†ã‚¹ãƒˆãŒä¸€æ™‚çš„ã«ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¦ã„ã‚‹ã€‚
   - TODO: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã® `test-data/generate` ã‚’èª¿æŸ»ã—ã€warehouse/product ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚’è¿½åŠ ã€‚
   - ç¾çŠ¶å›é¿ç­–: è©²å½“ãƒ†ã‚¹ãƒˆã‚’ `test.skip()` ã§ä¸€æ™‚çš„ã«ã‚¹ã‚­ãƒƒãƒ—ã€‚

2. **ãƒ­ã‚°ã‚¤ãƒ³401ã‚¨ãƒ©ãƒ¼ï¼ˆæ•£ç™ºçš„ - æœªç¢ºèªï¼‰**
   - ç—‡çŠ¶: ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”ŸæˆAPIã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚„å¤±æ•—ã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå­˜åœ¨ã›ãšãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã™ã‚‹ã€‚
   - ç¾çŠ¶: globalSetupå°å…¥å¾Œã¯æœªç™ºç”Ÿã€‚ç¶™ç¶šç›£è¦–ä¸­ã€‚

**è§£æ±ºæ¸ˆã¿ã‚¿ã‚¹ã‚¯:**
- âœ… DBãƒªã‚»ãƒƒãƒˆã®ä¸¦åˆ—å®Ÿè¡Œç«¶åˆã€socket hang upã€reset-database 500ã‚¨ãƒ©ãƒ¼ â†’ [ARCHIVE.md](./ARCHIVE.md) ã«ç§»å‹•æ¸ˆã¿

---

### 1-5. Phase 4-B: ã‚»ãƒ¼ãƒ–ãƒã‚¤ãƒ³ãƒˆãƒ»ãƒ­ãƒƒã‚¯è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

**å„ªå…ˆåº¦:** é«˜ï¼ˆPhase 4-Aå®Œäº†å¾Œï¼‰
**ä½œæˆ:** 2025-02-05
**ã‚«ãƒ†ã‚´ãƒª:** æ’ä»–åˆ¶å¾¡ãƒ»é‹ç”¨æ”¹å–„
**å·¥æ•°:** 1.5-2.5æ—¥

**èƒŒæ™¯:**
Phase 4èª¿æŸ»ã«ã‚ˆã‚Šã€éƒ¨åˆ†çš„å¤±æ•—å‡¦ç†ã¨ãƒ­ãƒƒã‚¯æœŸé™åˆ‡ã‚Œç®¡ç†ã®æ”¹å–„ãŒå¿…è¦ã¨åˆ¤æ˜ã€‚

**å®Ÿè£…å†…å®¹:**

#### 3-1. ã‚»ãƒ¼ãƒ–ãƒã‚¤ãƒ³ãƒˆå°å…¥ï¼ˆå·¥æ•°: 1-2æ—¥ï¼‰
- **ç›®çš„:** è¤‡æ•°ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£æ›´æ–°æ™‚ã®éƒ¨åˆ†çš„å¤±æ•—å‡¦ç†
- **ä¾‹:** å—æ³¨ã‚­ãƒ£ãƒ³ã‚»ãƒ«æ™‚ã® lot_reservations ä¸€æ‹¬å‰Šé™¤
- **å®Ÿè£…:**
  ```python
  with db.begin_nested():  # savepoint é–‹å§‹
      try:
          # äºˆç´„å‰Šé™¤å‡¦ç†
      except Exception:
          # savepoint ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
          # ä»–ã®å‡¦ç†ã¯ç¶™ç¶š
  ```

#### 3-2. ãƒ­ãƒƒã‚¯æœŸé™åˆ‡ã‚Œè‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆå·¥æ•°: 0.5æ—¥ï¼‰
- **ç›®çš„:** orders ãƒ†ãƒ¼ãƒ–ãƒ«ã®æœŸé™åˆ‡ã‚Œãƒ­ãƒƒã‚¯ã‚’å®šæœŸå‰Šé™¤
- **å®Ÿè£…:** ãƒãƒƒãƒã‚¸ãƒ§ãƒ–ã§æ—¥æ¬¡å®Ÿè¡Œ
  ```sql
  UPDATE orders
  SET locked_by_user_id = NULL, locked_at = NULL, lock_expires_at = NULL
  WHERE lock_expires_at < NOW() AND locked_by_user_id IS NOT NULL;
  ```

**æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ:**
- éƒ¨åˆ†çš„å¤±æ•—æ™‚ã®ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§å‘ä¸Š
- æœŸé™åˆ‡ã‚Œãƒ­ãƒƒã‚¯ã®è‡ªå‹•è§£æ”¾
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

**é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ:**
- `docs/project/PHASE4_CONCURRENCY_CONTROL_INVESTIGATION.md`

**å…ƒ:** Phase 4èª¿æŸ»çµæœï¼ˆ2025-02-05ï¼‰

---



## 2. å„ªå…ˆåº¦: ä¸­ (UI/UXãƒ»ä¸æ•´åˆä¿®æ­£)

### 2-1. Phase 4-C: OCRçµæœç·¨é›†æ©Ÿèƒ½ã®ç«¶åˆå¯¾ç­–

**å„ªå…ˆåº¦:** ä¸­ï¼ˆPhase 4-Aå®Œäº†å¾Œã€è©³ç´°ç¢ºèªãŒå¿…è¦ï¼‰
**ä½œæˆ:** 2025-02-05
**ã‚«ãƒ†ã‚´ãƒª:** æ’ä»–åˆ¶å¾¡ãƒ»ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§
**å·¥æ•°:** 1-2æ—¥ï¼ˆè©³ç´°ç¢ºèªå¾Œï¼‰

**èƒŒæ™¯:**
Phase 4èª¿æŸ»ã«ã‚ˆã‚Šã€OCRçµæœç·¨é›†æ©Ÿèƒ½ã®ç«¶åˆãƒªã‚¹ã‚¯ãŒæŒ‡æ‘˜ã•ã‚ŒãŸãŒã€è©³ç´°ãªç·¨é›†ãƒ•ãƒ­ãƒ¼ãŒä¸æ˜ã€‚

**ç¢ºèªäº‹é …:**
1. OCRçµæœç·¨é›†UIã®å®Ÿè£…çŠ¶æ³
2. ocr_results ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ›´æ–°å‡¦ç†
3. å—æ³¨å¤‰æ›å‡¦ç†ã¨ã®ä¸¦è¡Œå®Ÿè¡Œãƒªã‚¹ã‚¯

**å®Ÿè£…å†…å®¹ï¼ˆç¢ºèªå¾Œï¼‰:**
- SmartReadã¨åŒæ§˜ã®æ¥½è¦³çš„ãƒ­ãƒƒã‚¯å°å…¥
- version ã‚«ãƒ©ãƒ è¿½åŠ 
- ç«¶åˆæ™‚ã® 409 Conflict å‡¦ç†

**é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ:**
- `docs/project/PHASE4_CONCURRENCY_CONTROL_INVESTIGATION.md`

**å…ƒ:** Phase 4èª¿æŸ»çµæœï¼ˆ2025-02-05ï¼‰

---

### 2-3. SmartReadè¨­å®šãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã®E2Eãƒ†ã‚¹ãƒˆè¿½åŠ 

**å„ªå…ˆåº¦**: ä¸­
**ä½œæˆ**: 2026-01-31
**ã‚«ãƒ†ã‚´ãƒª**: ãƒ†ã‚¹ãƒˆå“è³ªå‘ä¸Š

**èƒŒæ™¯:**
- SmartReadè¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ«ã®ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ï¼ˆä½œæˆãƒ»æ›´æ–°ï¼‰ã¯ã€shadcn/uiã®Selectã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è¤‡é›‘ãªãƒ¢ãƒƒã‚¯è¦ä»¶ã«ã‚ˆã‚Šã€Vitestã§ã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆãŒå›°é›£
- ç¾åœ¨ã¯ãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤ºã®ã¿ãƒ†ã‚¹ãƒˆã•ã‚Œã¦ãŠã‚Šã€å®Ÿéš›ã®é€ä¿¡ãƒ•ãƒ­ãƒ¼ã¯æœªæ¤œè¨¼

**ã‚¿ã‚¹ã‚¯å†…å®¹:**
1. Playwrightã‚’ä½¿ç”¨ã—ãŸE2Eãƒ†ã‚¹ãƒˆã®è¿½åŠ 
   - SmartReadè¨­å®šã®æ–°è¦ä½œæˆãƒ•ãƒ­ãƒ¼
   - æ—¢å­˜è¨­å®šã®æ›´æ–°ãƒ•ãƒ­ãƒ¼
   - ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¢ºèª
2. ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«é…ç½®: `frontend/e2e/rpa-smartread-settings.spec.ts`

**å‚è€ƒ:**
- å‰Šé™¤ã•ã‚ŒãŸãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ: `frontend/src/features/rpa/smartread/components/SmartReadSettingsModal.test.tsx` (L120-168)
- æ—¢å­˜E2Eãƒ†ã‚¹ãƒˆ: `frontend/e2e/auth.spec.ts`, `frontend/e2e/allocation.spec.ts`

---

<<<<<<< HEAD
### 2-4. Toasté€šçŸ¥ã®ä¸è¶³

- ä¿å­˜æˆåŠŸæ™‚ã«ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãŒå‡ºãªã„ã€‚
- å¯¾è±¡:
  - `frontend/src/features/warehouses/hooks/useWarehouseMutations.ts`
  - `frontend/src/features/product-mappings/hooks/useProductMappings.ts`
  - `frontend/src/features/delivery-places/hooks/useDeliveryPlaces.ts`

**å…ƒ:** `backlog.md::2-5` (2026-01-18)

---

### 2-6. ProductDetailPage ã®ã‚³ãƒ¼ãƒ‰å¤‰æ›´å¾Œãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

- å•†å“ã‚³ãƒ¼ãƒ‰å¤‰æ›´æ™‚ã«URLãŒæ›´æ–°ã•ã‚Œãšè¡¨ç¤ºãŒæ®‹ã‚‹ã€‚
- å¯¾è±¡: `frontend/src/features/products/pages/ProductDetailPage.tsx`

**å…ƒ:** `backlog.md::2-6` (2026-01-18)

---

### 2-7. ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æ¸ˆã¿ãƒ­ãƒƒãƒˆã®è¡¨ç¤ºãƒã‚°

**ç—‡çŠ¶**: åœ¨åº«ãƒ­ãƒƒãƒˆä¸€è¦§ã§ã€Œã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æ¸ˆã¿ã‚’è¡¨ç¤ºã€ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦ã‚‚ã€ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æ¸ˆã¿ãƒ­ãƒƒãƒˆãŒè¡¨ç¤ºã•ã‚Œãªã„ï¼ˆã¾ãŸã¯æœŸå¾…é€šã‚Šã«æ©Ÿèƒ½ã—ãªã„ï¼‰ã€‚
**ã‚¿ã‚¹ã‚¯**: ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰/ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰ã®èª¿æŸ»ã¨ä¿®æ­£ã€‚

**é–¢é€£:** `next_reviews_ja.md::2`

---

### 2-8. ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã§ã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«å¤‰æ›´ãŒå®Ÿè¡Œä¸­ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«åæ˜ ã•ã‚Œãªã„

**å„ªå…ˆåº¦**: ä¸­ï¼ˆé•·æœŸå¯¾å¿œï¼‰
**ä½œæˆ**: 2026-02-01
**ã‚«ãƒ†ã‚´ãƒª**: å¯è¦³æ¸¬æ€§ãƒ»é‹ç”¨

**ç—‡çŠ¶:**
- ã‚·ã‚¹ãƒ†ãƒ è¨­å®šç”»é¢ã§ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’å¤‰æ›´ã—ã¦ã‚‚ã€å®Ÿè¡Œä¸­ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ã«ã¯åæ˜ ã•ã‚Œãªã„ã€‚
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®å†èµ·å‹•ãŒå¿…è¦ã€‚

**ç¾çŠ¶:**
- ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•æ™‚ã«ç’°å¢ƒå¤‰æ•°ã‹ã‚‰èª­ã¿è¾¼ã¾ã‚Œã‚‹ã€‚
- å‹•çš„å¤‰æ›´ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ãŒå­˜åœ¨ã—ãªã„ã€‚

**æ¨å¥¨å¯¾å¿œï¼ˆé•·æœŸï¼‰:**
1. ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«è¨­å®šã‚’DBã¾ãŸã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«æ°¸ç¶šåŒ–
2. è¨­å®šå¤‰æ›´ã‚’æ¤œçŸ¥ã—ã¦ãƒ­ã‚¬ãƒ¼ã‚’å†è¨­å®šã™ã‚‹ä»•çµ„ã¿ã‚’å®Ÿè£…
3. ã¾ãŸã¯ã€ç®¡ç†ç”»é¢ã«ã€Œè¨­å®šå¤‰æ›´ã«ã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å†èµ·å‹•ãŒå¿…è¦ã€ã¨æ˜ç¤º

---

### 2-9. ãƒ­ã‚°ãƒã‚¹ã‚­ãƒ³ã‚°ã®çµ±ä¸€ï¼ˆè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å¯¾å¿œï¼‰

**å„ªå…ˆåº¦**: ä¸­
**ä½œæˆ**: 2026-02-04
**ã‚«ãƒ†ã‚´ãƒª**: å¯è¦³æ¸¬æ€§ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

**èƒŒæ™¯:**
èªè¨¼ã‚„ç›£æŸ»ãƒ­ã‚°ã§ `username` ã‚„ `user_agent` ãªã©PIIãŒè¨˜éŒ²ã•ã‚Œã‚‹ãŒã€ç’°å¢ƒã‚„å®Ÿè£…ã«ã‚ˆã£ã¦ãƒã‚¹ã‚­ãƒ³ã‚°æœ‰ç„¡ãŒæºã‚Œã‚‹ã€‚å…¨ãƒ­ã‚°ã§ä¸€è²«ã—ãŸãƒã‚¹ã‚­ãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã‚’é©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

**ã‚¿ã‚¹ã‚¯å†…å®¹:**
1. `LOG_SENSITIVE_FIELDS` ã« `username`, `user_agent`, `client_ip` ãªã©ã‚’è¿½åŠ ã—ã¦ä¸€å…ƒç®¡ç†ã™ã‚‹ï¼ˆ`ip` ãªã©æ±ç”¨ã‚­ãƒ¼ã¯èª¤ãƒã‚¹ã‚¯ã®æã‚ŒãŒã‚ã‚‹ãŸã‚é¿ã‘ã‚‹ï¼‰ã€‚
2. ãƒ­ã‚°å‡ºåŠ›ã®ã‚­ãƒ¼åã‚’çµ±ä¸€ã—ã€PIIã¯å¿…ãš `extra` ã®æ§‹é€ åŒ–ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§å‡ºåŠ›ã™ã‚‹ã€‚
3. æœ¬ç•ªç’°å¢ƒã§ã®ãƒã‚¹ã‚­ãƒ³ã‚°å‹•ä½œã‚’ç¢ºèªã—ã€å¿…è¦ãªã‚‰ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¸è¨˜è¼‰ã™ã‚‹ã€‚

**å‚™è€ƒ:**
`backend/app/core/logging.py` ã®ãƒã‚¹ã‚­ãƒ³ã‚°å‡¦ç†ã¯ã‚­ãƒ¼åãƒ™ãƒ¼ã‚¹ã®ãŸã‚ã€ã‚­ãƒ¼åã®çµ±ä¸€ãŒå‰æã€‚

**é–¢é€£:**
- ãƒãƒƒã‚¯ãƒ­ã‚° 1-1 ã®æ®‹å­˜èª²é¡Œã‹ã‚‰æŠ½å‡º
- ãƒ–ãƒ©ãƒ³ãƒ: `fix/e2e-test-remaining-issues`

---



### 2-8. åœ¨åº«è©³ç´°ã®ä»•å…¥å…ˆå›ºå®š

**è¦æœ›**: åœ¨åº«è©³ç´°ç”»é¢ã«ãŠã„ã¦ã€ä»•å…¥å…ˆãŒå›ºå®šï¼ˆã¾ãŸã¯æ˜ç¢ºåŒ–ï¼‰ã•ã‚Œã‚‹ã¹ãã€‚
**ã‚¿ã‚¹ã‚¯**: è£½å“Ã—å€‰åº«ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«ãŠã‘ã‚‹ä»•å…¥å…ˆç‰¹å®šãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè£…ã¨UIåæ˜ ã€‚

**å…ƒ:** `backlog.md::8-4` (2026-01-18)

---

### 2-9. SmartReadå®Ÿè¡Œç”»é¢ã®å—æ³¨ç®¡ç†ãƒšãƒ¼ã‚¸ã¸ã®çµ±åˆ

**å„ªå…ˆåº¦**: Medium
**é›£æ˜“åº¦**: Medium
**æƒ³å®šå·¥æ•°**: 1-2æ—¥
**ä½œæˆæ—¥**: 2026-02-05

**èƒŒæ™¯ãƒ»èª²é¡Œ:**
- SmartReadã®å®Ÿè¡Œç”»é¢ãŒ `/rpa/smartread` ã«ã‚ã‚Šã€å—æ³¨ãƒ‡ãƒ¼ã‚¿å–ã‚Šè¾¼ã¿ã®ãŸã‚ã«åˆ¥ãƒšãƒ¼ã‚¸ã¸ç§»å‹•ãŒå¿…è¦
- å—æ³¨ç®¡ç†ãƒšãƒ¼ã‚¸ï¼ˆç¾åœ¨ã® `/ocr-results`ï¼‰ã‹ã‚‰ç›´æ¥å®Ÿè¡Œã§ãã‚‹ã¨ã€ãƒšãƒ¼ã‚¸é·ç§»ãªã—ã§ä½œæ¥­ãŒå®Œçµã™ã‚‹
- RPAãƒšãƒ¼ã‚¸ã¯è¨­å®šç®¡ç†ã®å½¹å‰²ã«ç‰¹åŒ–ã™ã¹ã

**æ”¹å–„æ¡ˆ:**
1. **å—æ³¨ç®¡ç†ãƒšãƒ¼ã‚¸ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã‚’è¿½åŠ **
   - ãƒšãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ãƒ¼ã¾ãŸã¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¨ãƒªã‚¢ã«ã€ŒSmartReadã§å–è¾¼ã€ãƒœã‚¿ãƒ³
   - ã‚¯ãƒªãƒƒã‚¯ã§ãƒ¢ãƒ¼ãƒ€ãƒ«ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º

2. **ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã®å®Ÿè£…**
   - ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠUIï¼ˆãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å¯¾å¿œï¼‰
   - SmartReadè¨­å®šã®é¸æŠï¼ˆãƒ—ãƒªã‚»ãƒƒãƒˆï¼‰
   - ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ å‡¦ç†å®Ÿè¡Œ
   - é€²æ—è¡¨ç¤ºï¼ˆå‡¦ç†ä¸­ãƒ»å®Œäº†ï¼‰

3. **å‡¦ç†å®Œäº†å¾Œã®æŒ™å‹•**
   - ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã¦å—æ³¨ç®¡ç†ãƒšãƒ¼ã‚¸ã«ç•™ã¾ã‚‹
   - æ–°ã—ã„OCRçµæœãŒè‡ªå‹•çš„ã«ãƒªã‚¹ãƒˆã«è¿½åŠ ã•ã‚Œã‚‹
   - ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã§å®Œäº†ã‚’é€šçŸ¥

4. **RPAãƒšãƒ¼ã‚¸ã®å½¹å‰²å¤‰æ›´**
   - SmartReadè¨­å®šã®ç®¡ç†ï¼ˆãƒ—ãƒªã‚»ãƒƒãƒˆä½œæˆãƒ»ç·¨é›†ï¼‰
   - ç›£è¦–ãƒ•ã‚©ãƒ«ãƒ€è¨­å®š
   - å®Ÿè¡Œå±¥æ­´ã®è©³ç´°ç¢ºèª

**æŠ€è¡“çš„æ¤œè¨:**
- æ—¢å­˜ã® `SmartReadUploadPanel` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å†åˆ©ç”¨
- ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ: shadcn/ui Dialog
- çŠ¶æ…‹ç®¡ç†: TanStack Query ã® mutation
- å‡¦ç†å®Œäº†æ¤œçŸ¥: ãƒãƒ¼ãƒªãƒ³ã‚°ã¾ãŸã¯æ—¢å­˜ã®é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ é€£æº

**é–¢é€£ã‚¿ã‚¹ã‚¯:**
- `/ocr-results` ã®ãƒ«ãƒ¼ãƒˆåå¤‰æ›´ï¼ˆå°†æ¥ã‚¿ã‚¹ã‚¯ï¼‰
- 2-10. SmartRead OCRå‡¦ç†å®Œäº†é€šçŸ¥æ©Ÿèƒ½ï¼ˆä¸‹è¨˜ï¼‰

**å…ƒ:** ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æœ› (2026-02-05)

---

### 2-10. SmartRead OCRå‡¦ç†å®Œäº†é€šçŸ¥æ©Ÿèƒ½

**å„ªå…ˆåº¦**: Medium
**é›£æ˜“åº¦**: Medium
**æƒ³å®šå·¥æ•°**: 1-2æ—¥

**èƒŒæ™¯ãƒ»èª²é¡Œ:**
- SmartRead OCRå‡¦ç†ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»ç›£è¦–ãƒ•ã‚©ãƒ«ãƒ€ï¼‰ã¯ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å®Ÿè¡Œã•ã‚Œã‚‹
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå‡¦ç†ä¸­ã«ä»–ã®ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã™ã‚‹ã¨ã€å‡¦ç†å®Œäº†ã‚’çŸ¥ã‚‹æ‰‹æ®µãŒãªã„
- OCRçµæœãƒšãƒ¼ã‚¸ã‚’å®šæœŸçš„ã«ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€UXãŒæ‚ªã„

**ç¾çŠ¶ã®å‹•ä½œ:**
1. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†é–‹å§‹
   - å³å´ï¼ˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼‰: FastAPI `BackgroundTasks` (éåŒæœŸã€è»½é‡)
   - å·¦å´ï¼ˆç›£è¦–ãƒ•ã‚©ãƒ«ãƒ€ï¼‰: `threading.Thread` (åŒæœŸI/Oã€ZIPå‡¦ç†ç­‰ã®é‡ã„å‡¦ç†)
2. å³åº§ã«202 Acceptedãƒ¬ã‚¹ãƒãƒ³ã‚¹
3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒšãƒ¼ã‚¸ã‚’é›¢ã‚Œã¦ã‚‚å‡¦ç†ã¯ç¶™ç¶šã•ã‚Œã‚‹ âœ…
4. ã—ã‹ã—ã€**å‡¦ç†å®Œäº†ã®é€šçŸ¥ãŒãªã„** âŒ

**æ³¨æ„:** å·¦å³ã§ç•°ãªã‚‹ä¸¦è¡Œå‡¦ç†æ–¹å¼ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŒã€ã“ã‚Œã¯å‡¦ç†ã®é‡ã•ã«å¿œã˜ãŸæœ€é©åŒ–ã§ã‚ã‚Šã€
æœ€çµ‚çš„ãªOCRçµæœã®ä¿å­˜å…ˆã¯å…±é€šï¼ˆ`smartread_wide_data`, `smartread_long_data`ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰ã€‚

**è¦ä»¶:**
1. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥** (Phase 1)
   - OCRå‡¦ç†ãŒå®Œäº†ã—ãŸã‚‰ãƒ–ãƒ©ã‚¦ã‚¶é€šçŸ¥ã¾ãŸã¯ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥
   - ä»–ã®ãƒšãƒ¼ã‚¸ã«ã„ã¦ã‚‚é€šçŸ¥ã‚’å—ã‘å–ã‚Œã‚‹

2. **é€šçŸ¥å±¥æ­´ã®ä¿å­˜** (Phase 2)
   - æœªèª­é€šçŸ¥ã‚’ã‚¹ã‚¿ãƒƒã‚¯ã—ã¦ä¿å­˜
   - ãƒ˜ãƒƒãƒ€ãƒ¼ã«ãƒ™ãƒ«ã‚¢ã‚¤ã‚³ãƒ³ + æœªèª­ãƒãƒƒã‚¸
   - é€šçŸ¥ä¸€è¦§ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã§ç¢ºèªå¯èƒ½
   - ã€ŒOCRèª­ã¿è¾¼ã¿å®Œäº†: ãƒ•ã‚¡ã‚¤ãƒ«å.pdfã€ç­‰ã®è©³ç´°è¡¨ç¤º

**æŠ€è¡“çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:**

**Option 1: WebSocket / Server-Sent Events (SSE)**
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæ–¹å‘é€šä¿¡
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‹ã‚‰å‡¦ç†å®Œäº†æ™‚ã«pushé€šçŸ¥
- å®Ÿè£…ã‚³ã‚¹ãƒˆ: é«˜

**Option 2: ãƒãƒ¼ãƒªãƒ³ã‚° (æ¨å¥¨)**
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒå®šæœŸçš„ã« `/api/notifications` ã‚’ãƒã‚§ãƒƒã‚¯
- å®Ÿè£…ã‚³ã‚¹ãƒˆ: ä½
- React Queryã®refetchIntervalã§ç°¡å˜å®Ÿè£…å¯èƒ½

**å®Ÿè£…ã‚¿ã‚¹ã‚¯:**
1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰:
   - é€šçŸ¥ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ (user_id, message, type, read, created_at)
   - SmartReadå‡¦ç†å®Œäº†æ™‚ã«é€šçŸ¥ãƒ¬ã‚³ãƒ¼ãƒ‰æŒ¿å…¥
   - GET /api/notifications ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ (æœªèª­é€šçŸ¥å–å¾—)
   - PATCH /api/notifications/{id}/read ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ (æ—¢èª­åŒ–)

2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰:
   - é€šçŸ¥ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ/ã‚¹ãƒˆã‚¢ (Jotai)
   - ãƒ˜ãƒƒãƒ€ãƒ¼ã«ãƒ™ãƒ«ã‚¢ã‚¤ã‚³ãƒ³ + æœªèª­ãƒãƒƒã‚¸
   - é€šçŸ¥ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
   - useNotifications hook (ãƒãƒ¼ãƒªãƒ³ã‚°: 30ç§’é–“éš”)
   - ãƒ–ãƒ©ã‚¦ã‚¶é€šçŸ¥APIçµ±åˆ (Notification API)

3. SmartReadçµ±åˆ:
   - `_run_simple_sync_background` å‡¦ç†å®Œäº†æ™‚ã«é€šçŸ¥ä½œæˆ
   - PAD Runå®Œäº†æ™‚ã«é€šçŸ¥ä½œæˆ

**å‚è€ƒå®Ÿè£…:**
- GitHubé€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ 
- Slacké€šçŸ¥ã‚»ãƒ³ã‚¿ãƒ¼

**å…ƒ:** ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æœ› (2026-01-30)

---

### 2-10. SmartRead: ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã¨ãƒ•ã‚©ãƒ«ãƒ€ç›£è¦–ã®å‡¦ç†çµ±ä¸€

**å„ªå…ˆåº¦**: Medium
**é›£æ˜“åº¦**: Medium
**æƒ³å®šå·¥æ•°**: 1-2æ—¥
**å‰æ**: æœ¬ç•ªç’°å¢ƒã§ãƒ­ã‚°ç¢ºèªå¾Œã«ç€æ‰‹

**èƒŒæ™¯ãƒ»èª²é¡Œ:**
- ç¾åœ¨ã€å³å´ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼‰ã¨å·¦å´ï¼ˆç›£è¦–ãƒ•ã‚©ãƒ«ãƒ€ï¼‰ã§ç•°ãªã‚‹å‡¦ç†æ–¹å¼ã‚’ä½¿ç”¨
- å³å´: `/analyze-simple` â†’ `BackgroundTasks` â†’ `sync_with_simple_flow`
- å·¦å´: `/pad-runs` â†’ `threading.Thread` â†’ `execute_run`
- å³å´ã®å‡¦ç†ãŒå®Ÿéš›ã«å‹•ä½œã—ã¦ã„ãŸã‹ä¸æ˜ï¼ˆOCRçµæœã«é‡è¤‡ãŒãªã„ = å‹•ã„ã¦ã„ãªã„å¯èƒ½æ€§ï¼‰
- å‡¦ç†ãƒ‘ã‚¹ãŒåˆ†ã‹ã‚Œã¦ã„ã‚‹ãŸã‚ã€ãƒã‚°ã®æ··å…¥ãƒªã‚¹ã‚¯ãŒé«˜ã„

**ç¾çŠ¶ã®å•é¡Œç‚¹:**
```
å³å´ï¼ˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼‰:
  UploadFileå—ä¿¡ â†’ analyze-simple API
    â†’ BackgroundTasks.add_task(_run_simple_sync_background)
    â†’ SmartReadService.sync_with_simple_flow (async)
    â†’ OCRçµæœä¿å­˜ï¼ˆå‹•ä½œæœªç¢ºèªï¼‰

å·¦å´ï¼ˆç›£è¦–ãƒ•ã‚©ãƒ«ãƒ€ï¼‰:
  filenameså—ä¿¡ â†’ pad-runs API
    â†’ threading.Thread(execute_run)
    â†’ SmartReadPadRunnerService.execute_run (sync)
    â†’ OCRçµæœä¿å­˜ï¼ˆå‹•ä½œç¢ºèªæ¸ˆã¿ âœ…ï¼‰
```

**çµ±ä¸€æ–¹é‡:**
- **å³å´ã‚’å·¦å´ï¼ˆPAD Runï¼‰æ–¹å¼ã«çµ±ä¸€**
- ã‚ã–ã‚ã–ç›£è¦–ãƒ•ã‚©ãƒ«ãƒ€ã«ä¸€æ™‚ä¿å­˜ã›ãšã€ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›´æ¥PAD Runã«æ¸¡ã™
- åŒã˜å‡¦ç†ãƒ‘ã‚¹ã‚’é€šã‚‹ã“ã¨ã§ã€ç¢ºå®Ÿæ€§ã¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ€§ã‚’å‘ä¸Š

**å®Ÿè£…ã‚¿ã‚¹ã‚¯:**

1. **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰:**
   - æ–°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¿½åŠ : `POST /configs/{config_id}/pad-runs/upload`
   - `UploadFile` ã‚’å—ã‘å–ã‚Šã€PAD Runã‚’é–‹å§‹
   - å†…éƒ¨ã§ `SmartReadPadRunnerService.execute_run` ã‚’ä½¿ç”¨
   - ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ã¯ä¸è¦ï¼ˆãƒ¡ãƒ¢ãƒªä¸Šã§å‡¦ç†ï¼‰

2. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰:**
   - `SmartReadUploadPanel` ã‚’ `useStartPadRun` ç›¸å½“ã®hookã«å¤‰æ›´
   - æ—¢å­˜ã® `useAnalyzeFile` ã‚’å»ƒæ­¢
   - `handleAnalyzeSuccess` ã¯æ—¢ã«ä¿®æ­£æ¸ˆã¿ï¼ˆã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆæ›´æ–°ï¼‰

3. **æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã®æ•´ç†:**
   - `/analyze-simple` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’éæ¨å¥¨åŒ–ï¼ˆã¾ãŸã¯å‰Šé™¤ï¼‰
   - `sync_with_simple_flow` ã®ä½¿ç”¨ç®‡æ‰€ã‚’ç¢ºèªãƒ»æ•´ç†

**æŠ€è¡“çš„è©³ç´°:**

```python
# æ–°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¾‹
@router.post("/configs/{config_id}/pad-runs/upload")
async def start_pad_run_from_upload(
    config_id: int,
    file: UploadFile,
    uow: UnitOfWork = Depends(get_uow),
    _current_user: User = Depends(get_current_user),
) -> SmartReadPadRunStartResponse:
    """ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰PAD Runã‚’é–‹å§‹."""
    file_content = await file.read()
    filename = file.filename or "uploaded_file"

    # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦æ‰±ã†ï¼ˆç›£è¦–ãƒ•ã‚©ãƒ«ãƒ€ä¸è¦ï¼‰
    runner = SmartReadPadRunnerService(uow.session)
    run_id = runner.start_run_from_upload(config_id, filename, file_content)

    # æ—¢å­˜ã®PAD Runæ–¹å¼ã§ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œ
    # ...
```

**ãƒ¡ãƒªãƒƒãƒˆ:**
1. å·¦å³ã§åŒã˜ã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¹ã‚’é€šã‚‹ â†’ ãƒã‚°ãŒæ¸›ã‚‹
2. PAD Runã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†ã‚’çµ±ä¸€åˆ©ç”¨ â†’ ãƒ‡ãƒãƒƒã‚°ã—ã‚„ã™ã„
3. å®Ÿç¸¾ã®ã‚ã‚‹æ–¹å¼ã«çµ±ä¸€ â†’ ç¢ºå®Ÿæ€§ãŒå‘ä¸Š
4. ã‚³ãƒ¼ãƒ‰ã®é‡è¤‡ã‚’å‰Šæ¸› â†’ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ€§å‘ä¸Š

**æ³¨æ„äº‹é …:**
- æœ¬ç•ªç’°å¢ƒã§å³å´ã®å‹•ä½œãƒ­ã‚°ã‚’ç¢ºèªã—ã¦ã‹ã‚‰ç€æ‰‹
- ã‚‚ã—å³å´ãŒå®Ÿéš›ã«å‹•ã„ã¦ã„ãŸå ´åˆã€çµ±ä¸€ã«ã‚ˆã‚‹å½±éŸ¿ã‚’æ…é‡ã«è©•ä¾¡

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«:**
- `backend/app/presentation/api/routes/rpa/smartread_router.py`
- `backend/app/application/services/smartread/pad_runner_service.py`
- `frontend/src/features/rpa/smartread/components/SmartReadUploadPanel.tsx`
- `frontend/src/features/rpa/smartread/hooks/file-hooks.ts`

**å…ƒ:** ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æœ› (2026-01-30)

---

---

### 2-11. ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã®å‹•çš„å¤‰æ›´æ©Ÿèƒ½

**å„ªå…ˆåº¦**: ä¸­
**ä½œæˆ**: 2026-02-01
**ã‚«ãƒ†ã‚´ãƒª**: é‹ç”¨ãƒ»ç›£è¦–

**èƒŒæ™¯:**
- ã‚·ã‚¹ãƒ†ãƒ è¨­å®šç”»é¢ã§ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’ DEBUG ã«å¤‰æ›´ã—ã¦ã‚‚ã€å®Ÿè¡Œä¸­ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«ã¯åæ˜ ã•ã‚Œãªã„
- ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã¯èµ·å‹•æ™‚ã« `settings.LOG_LEVEL` ã‹ã‚‰è¨­å®šã•ã‚Œã€ä»¥é™ã¯å›ºå®šã•ã‚Œã‚‹
- ãƒ‡ãƒãƒƒã‚°æ™‚ã«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®å†èµ·å‹•ãŒå¿…è¦ã§ã€é‹ç”¨ä¸Šä¸ä¾¿

**ç¾çŠ¶ã®å‹•ä½œ:**
1. ã‚·ã‚¹ãƒ†ãƒ è¨­å®šç”»é¢ã§ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’å¤‰æ›´ â†’ DB (`system_configs`) ã«ä¿å­˜
2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰èµ·å‹•æ™‚ã« `configure_logging()` ãŒ `settings.LOG_LEVEL` ã‚’èª­ã¿è¾¼ã¿
3. å®Ÿè¡Œä¸­ã¯ `logging.getLogger().setLevel()` ã‚’å‘¼ã‚“ã§ã‚‚ã€æ§‹é€ åŒ–ãƒ­ã‚°è¨­å®šãŒå†æ§‹ç¯‰ã•ã‚Œãªã„

**ã‚¿ã‚¹ã‚¯å†…å®¹:**
1. ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«å¤‰æ›´APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®è¿½åŠ  (`POST /api/admin/log-level`)
2. `configure_logging()` ã‚’å‘¼ã³å‡ºã—ã¦ã€å®Ÿè¡Œä¸­ã®ãƒ­ã‚°è¨­å®šã‚’æ›´æ–°
3. ã‚·ã‚¹ãƒ†ãƒ è¨­å®šç”»é¢ã«ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«å¤‰æ›´ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ï¼ˆã¾ãŸã¯ä¿å­˜æ™‚ã«è‡ªå‹•åæ˜ ï¼‰

**å‚è€ƒãƒ•ã‚¡ã‚¤ãƒ«:**
- `backend/app/core/logging.py` - `configure_logging()` é–¢æ•°
- `backend/app/core/config.py` - `LOG_LEVEL` è¨­å®š
- `frontend/src/features/system/SystemSettingsPage.tsx` - ã‚·ã‚¹ãƒ†ãƒ è¨­å®šç”»é¢

---

### 2-12. E2Eãƒ†ã‚¹ãƒˆã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ”¹å–„

**å„ªå…ˆåº¦**: ä¸­
**ä½œæˆ**: 2026-02-01
**ã‚«ãƒ†ã‚´ãƒª**: ãƒ†ã‚¹ãƒˆå“è³ª

**èƒŒæ™¯:**
- E2Eãƒ†ã‚¹ãƒˆã® `api-client.ts` ã§ä¸€éƒ¨ã®ã‚¨ãƒ©ãƒ¼ã‚’æ¡ã‚Šã¤ã¶ã—ã¦ã„ã‚‹
- `generateTestData()` ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ãŸå ´åˆã€è­¦å‘Šã®ã¿å‡ºã—ã¦ç¶šè¡Œã™ã‚‹
- ãƒ†ã‚¹ãƒˆå¤±æ•—ã®åŸå› ãŒä¸æ˜ç­ã«ãªã‚‹

**ã‚¿ã‚¹ã‚¯å†…å®¹:**
1. `api-client.ts` ã®å…¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ç®‡æ‰€ã‚’ç²¾æŸ»
2. æ¡ã‚Šã¤ã¶ã™ã¹ãã‚¨ãƒ©ãƒ¼ã¨ã€ã‚¹ãƒ­ãƒ¼ã™ã¹ãã‚¨ãƒ©ãƒ¼ã‚’æ˜ç¢ºåŒ–
3. ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ”¹å–„ã—ã€ãƒ‡ãƒãƒƒã‚°ã—ã‚„ã™ãã™ã‚‹

**å‚è€ƒ:**
- `frontend/e2e/fixtures/api-client.ts` - L150-162 (`generateTestData`)
- `frontend/e2e/fixtures/db-reset.ts` - ä¿®æ­£æ¸ˆã¿ï¼ˆã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ï¼‰

---

### 2-13. ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”ŸæˆãŒ warehouse/product ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ãªã„

**å„ªå…ˆåº¦**: ä¸­
**ä½œæˆ**: 2026-02-01
**ã‚«ãƒ†ã‚´ãƒª**: E2Eãƒ†ã‚¹ãƒˆãƒ»ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿

**ç—‡çŠ¶:**
- `POST /api/admin/test-data/generate` ã‚’å‘¼ã³å‡ºã—ã¦ã‚‚ã€warehouse/product ãƒ‡ãƒ¼ã‚¿ãŒç”Ÿæˆã•ã‚Œãªã„ã€‚
- `e2e-02-save-persistence.spec.ts` ã®2ãƒ†ã‚¹ãƒˆãŒä¸€æ™‚çš„ã«ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¦ã„ã‚‹ã€‚

**å½±éŸ¿ç¯„å›²:**
- å€‰åº«ãƒã‚¹ã‚¿ãƒ»è£½å“ãƒã‚¹ã‚¿ã®E2Eãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã§ããªã„ã€‚
- æ‰‹å‹•ã§ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ãŒå¿…è¦ã€‚

**æ¨å¥¨å¯¾å¿œ:**
1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã® `test-data/generate` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…ã‚’èª¿æŸ»
2. warehouse/product ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ã‚’è¿½åŠ 
3. e2e-02 ã® `test.skip()` ã‚’å‰Šé™¤ã—ã¦å†æœ‰åŠ¹åŒ–

**ç¾çŠ¶å›é¿ç­–:**
- è©²å½“ãƒ†ã‚¹ãƒˆã‚’ `test.skip(true, "ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”ŸæˆãŒå€‰åº«/è£½å“ã‚’ä½œæˆã—ãªã„ãŸã‚ã€ä¸€æ™‚çš„ã«ã‚¹ã‚­ãƒƒãƒ—")` ã§ä¸€æ™‚ã‚¹ã‚­ãƒƒãƒ—ã€‚

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«:**
- `frontend/e2e/specs/p0/e2e-02-save-persistence.spec.ts` (L27, L159)
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: `app/presentation/api/routes/admin/*` (test-dataç”Ÿæˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ)

---

### 2-14. SmartRead CSVå¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯ã®æ”¹å–„

**å„ªå…ˆåº¦**: ä¸­
**ä½œæˆ**: 2026-02-02
**ã‚«ãƒ†ã‚´ãƒª**: RPAãƒ»ãƒ‡ãƒ¼ã‚¿å‡¦ç†

**èƒŒæ™¯:**
- `SmartReadCsvTransformer` ã«ã‚ˆã‚‹æ¨ªæŒã¡â†’ç¸¦æŒã¡å¤‰æ›ã«ãŠã„ã¦ã€ãƒ‡ãƒ¼ã‚¿ã®ä¿¡é ¼æ€§ã¨ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥èƒ½åŠ›ã‚’å‘ä¸Šã•ã›ã‚‹ã€‚

**ã‚¿ã‚¹ã‚¯å†…å®¹:**
1. **ç¸¦æŒã¡ãƒ‡ãƒ¼ã‚¿ã®é‡è¤‡ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½ã®å®Ÿè£…**
   - å¤‰æ›å¾Œã®ãƒ‡ãƒ¼ã‚¿ï¼ˆ`long_data`ï¼‰å†…ã§ã€åŒä¸€ã®æè³ªãƒ»Lot Noãƒ»æ•°é‡ç­‰ã‚’æŒã¤ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒé‡è¤‡ã—ã¦ç”Ÿæˆã•ã‚Œã¦ã„ãªã„ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã®è¿½åŠ ã€‚
2. **æ˜ç´°æœªç”Ÿæˆæ™‚ã®è­¦å‘Šæ©Ÿèƒ½ã®å®Ÿè£…**
   - æ˜ç´°é …ç›®ãŒ1ä»¶ã‚‚æŠ½å‡ºã•ã‚Œãªã‹ã£ãŸå ´åˆã€CSVãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ä¸ä¸€è‡´ï¼ˆåˆ—åã®å¤‰æ›´ãªã©ï¼‰ã®å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è­¦å‘Šã‚’å‡ºã™ä»•çµ„ã¿ã®å°å…¥ã€‚

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«:**
- `backend/app/application/services/smartread/csv_transformer.py`
- `docs/smartread_csv_validation_report.md`

---

## 3. DB/UIæ•´åˆæ€§ãƒ»ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºæ”¹å–„

---

### 3-3. å¤§é‡ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã®å®Œå…¨å¯¾å¿œ (ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³)

**å„ªå…ˆåº¦**: High
**é›£æ˜“åº¦**: Medium
**æƒ³å®šå·¥æ•°**: 2-3æ—¥

**èƒŒæ™¯ãƒ»èª²é¡Œ:**
- ä¸€éƒ¨ã®APIï¼ˆãƒ­ãƒƒãƒˆå–å¾—ç­‰ï¼‰ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® `limit: 100` ãŒã‚ã‚Šã€ãƒšãƒ¼ã‚¸ãƒ³ã‚°ãŒãªã„ãŸã‚å¤§é‡ãƒ‡ãƒ¼ã‚¿æ™‚ã«æ¬ è½ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã€‚
- å…¨ä»¶å–å¾—ã—ã¦ã‹ã‚‰ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§çµã‚Šè¾¼ã‚€å®Ÿè£…ã‚’å»ƒæ­¢ã—ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ»ãƒ¡ãƒ¢ãƒªè² è·ã‚’è»½æ¸›ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

**ã‚¿ã‚¹ã‚¯å†…å®¹:**
1. ãƒ­ãƒƒãƒˆä¸€è¦§ãŠã‚ˆã³åœ¨åº«ä¸€è¦§APIã¸ã®å®Œå…¨ãªã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å°å…¥ã€‚
2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ã®ç„¡é™ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã¾ãŸã¯ãƒãƒ¼ãƒãƒ£ãƒ«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯¾å¿œã€‚

**å…ƒ:** `FUTURE_IMPROVEMENTS.md`

---

## 4. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£/å“è³ªæ”¹å–„

### 4-0. Alembicãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³: ãƒ“ãƒ¥ãƒ¼å†ç”Ÿæˆã®è‡ªå‹•åŒ–

**å„ªå…ˆåº¦**: ä½
**ä½œæˆ**: 2026-02-04
**ã‚«ãƒ†ã‚´ãƒª**: ã‚¤ãƒ³ãƒ•ãƒ©ãƒ»DBãƒ»é–‹ç™ºä½“é¨“

**èƒŒæ™¯:**
- ç¾åœ¨ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ“ãƒ¥ãƒ¼ã¯æœ€å¾Œã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ (`62a340dbe783_recreate_views_after_schema_changes.py`) ã§ `create_views.sql` ã‚’å®Ÿè¡Œã—ã¦å†ç”Ÿæˆã•ã‚Œã‚‹
- æ–°ã—ã„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã™ã‚‹åº¦ã«ã€ä»¥ä¸‹ã®æ‰‹å‹•ä½œæ¥­ãŒå¿…è¦ã«ãªã‚‹ï¼š
  1. æ—¢å­˜ã®æœ€å¾Œã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ `create_views.sql` å®Ÿè¡Œå‡¦ç†ã‚’å‰Šé™¤
  2. æ–°ã—ã„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®æœ€å¾Œã« `create_views.sql` å®Ÿè¡Œå‡¦ç†ã‚’è¿½åŠ 
- ã“ã®æ‰‹å‹•ä½œæ¥­ã¯å¿˜ã‚Œã‚„ã™ãã€ãƒ“ãƒ¥ãƒ¼ã®æ•´åˆæ€§å•é¡Œã‚’å¼•ãèµ·ã“ã™å¯èƒ½æ€§ãŒã‚ã‚‹

**èª²é¡Œ:**
- ä¸­é–“ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒ“ãƒ¥ãƒ¼ã‚’å†ç”Ÿæˆã™ã‚‹ã¨ã€ã‚¹ã‚­ãƒ¼ãƒãŒä¸å®Œå…¨ãªçŠ¶æ…‹ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹
- ã‹ã¨ã„ã£ã¦æ‰‹å‹•ã§æ¯å›ç§»å‹•ã•ã›ã‚‹ã®ã¯ç…©é›‘ã§ã‚¨ãƒ©ãƒ¼ãŒèµ·ãã‚„ã™ã„

**ææ¡ˆã•ã‚Œã‚‹è§£æ±ºç­–:**

**Option 1: Alembic hooks ã‚’ä½¿ç”¨ã—ãŸè‡ªå‹•åŒ–**
- `alembic/env.py` ã§ `after_upgrade` hook ã‚’ä½¿ç”¨
- `alembic upgrade head` å®Ÿè¡Œå¾Œã«è‡ªå‹•çš„ã« `create_views.sql` ã‚’å®Ÿè¡Œ
- ãƒ¡ãƒªãƒƒãƒˆ: å„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¿°ä¸è¦ã€å®Œå…¨è‡ªå‹•åŒ–
- ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ: downgradeæ™‚ã®å¯¾å¿œãŒè¤‡é›‘

**Option 2: å°‚ç”¨ã®ãƒ“ãƒ¥ãƒ¼ç®¡ç†ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**
- `scripts/recreate_views.py` ã®ã‚ˆã†ãªç‹¬ç«‹ã—ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆ
- ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¾Œã«æ‰‹å‹•ã§å®Ÿè¡Œ: `make db-recreate-views`
- ãƒ¡ãƒªãƒƒãƒˆ: ã‚·ãƒ³ãƒ—ãƒ«ã€æ˜ç¤ºçš„ã€downgradeã®å½±éŸ¿ã‚’å—ã‘ãªã„
- ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ: å®Ÿè¡Œã‚’å¿˜ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹

**Option 3: æœ€çµ‚ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒãƒ¼ã‚«ãƒ¼**
- ç‰¹æ®Šãªå‘½åè¦å‰‡ï¼ˆä¾‹: `zz_final_views.py`ï¼‰ã§æœ€çµ‚ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è­˜åˆ¥
- æ–°è¦ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆæ™‚ã«è‡ªå‹•ãƒªãƒãƒ¼ãƒ 
- ãƒ¡ãƒªãƒƒãƒˆ: ãƒ•ã‚¡ã‚¤ãƒ«åã§æ„å›³ãŒæ˜ç¢º
- ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ: è‡ªå‹•åŒ–ã«ã¯è¿½åŠ ãƒ„ãƒ¼ãƒ«ãŒå¿…è¦

**æ¨å¥¨ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:** Option 1 (Alembic hooks)
- æœ€ã‚‚è‡ªå‹•åŒ–ã•ã‚Œã¦ãŠã‚Šã€äººçš„ã‚¨ãƒ©ãƒ¼ã‚’æ’é™¤ã§ãã‚‹
- `alembic/env.py` ã® `run_migrations_online()` ã«æ•°è¡Œè¿½åŠ ã™ã‚‹ã ã‘ã§å®Ÿè£…å¯èƒ½

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«:**
- `backend/alembic/env.py`
- `backend/alembic/versions/62a340dbe783_recreate_views_after_schema_changes.py`
- `backend/sql/views/create_views.sql`

---

### 4-1. useQuery ã®ã‚¨ãƒ©ãƒ¼å‡¦ç†è¿½åŠ ï¼ˆPhase 2ï¼‰

- `AllocationDialog.tsx`, `ForecastsTab.tsx`, `InboundPlansTab.tsx`, `WithdrawalCalendar.tsx` ãªã©ã€‚

**å…ƒ:** `backlog.md::4-1` (2026-01-18)

---

### 4-3. å‰Šé™¤ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®çµ±åˆ

- `SoftDeleteDialog`, `PermanentDeleteDialog`, `BulkSoftDeleteDialog`, `BulkPermanentDeleteDialog` ã‚’çµ±åˆã€‚

**å…ƒ:** `backlog.md::4-3` (2026-01-18)

---

### 4-4. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: Soft Delete Utilsã«ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’å°å…¥

**å„ªå…ˆåº¦**: Medium (anyå‹å‰Šæ¸› Phase 2)
**å¯¾è±¡**: 17ç®‡æ‰€

**å ´æ‰€**: `app/application/services/common/soft_delete_utils.py`

**ç¾çŠ¶:**
```python
def get_product_name(product: Any, default: str = "") -> str:
    """è£½å“åã‚’å®‰å…¨ã«å–å¾— (è«–ç†å‰Šé™¤å¯¾å¿œ)"""
    if product is None:
        return default
    return getattr(product, "product_name", default)
```

**å¯¾å¿œ:**
```python
from typing import Protocol, Optional

class HasProductName(Protocol):
    product_name: str

def get_product_name(product: Optional[HasProductName], default: str = "") -> str:
    """è£½å“åã‚’å®‰å…¨ã«å–å¾— (è«–ç†å‰Šé™¤å¯¾å¿œ)"""
    if product is None:
        return default
    return product.product_name
```

**å…ƒ:** `any-type-reduction.md` (2026-01-18)

---

### 4-6. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: ProductMapping é–¢é€£ã‚³ãƒ¼ãƒ‰ã®å‰Šé™¤

**å„ªå…ˆåº¦**: Low
**ä½œæˆ**: 2026-01-31
**ã‚«ãƒ†ã‚´ãƒª**: ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

**èƒŒæ™¯:**
- 2026-01-31ã®ãƒã‚¹ã‚¿ãƒšãƒ¼ã‚¸æ”¹ä¿®ã«ã‚ˆã‚Šã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ã€Œå•†å“ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆ`ProductMapping`ï¼‰ã€ãƒšãƒ¼ã‚¸ãŒå‰Šé™¤ã•ã‚Œã€æ©Ÿèƒ½ã¯ã€Œå¾—æ„å…ˆå“ç•ªãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆ`CustomerItem`ï¼‰ã€ã«ä¸€å…ƒåŒ–ã•ã‚ŒãŸã€‚
- ã—ã‹ã—ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«ã¯ `ProductMapping` ãƒ¢ãƒ‡ãƒ«ã€Routerã€Serviceã€Import/Exportãƒ­ã‚¸ãƒƒã‚¯ãŒæ®‹å­˜ã—ã¦ã„ã‚‹ã€‚
- ã“ã‚Œã‚‰ã¯ `replenishment/engine.py` ç­‰ã‹ã‚‰å‚ç…§ã•ã‚Œã¦ãŠã‚Šã€å½±éŸ¿èª¿æŸ»ãŒå¿…è¦ãªãŸã‚ä»Šå›ã¯æ¸©å­˜ã•ã‚ŒãŸã€‚

**ã‚¿ã‚¹ã‚¯å†…å®¹:**
1. `ProductMapping` ã®å‚ç…§ç®‡æ‰€ã‚’æ´—ã„å‡ºã™ã€‚
2. å¿…è¦ãªãƒ­ã‚¸ãƒƒã‚¯ï¼ˆã‚‚ã—ã‚ã‚Œã°ï¼‰ã‚’ `CustomerItem` ãƒ™ãƒ¼ã‚¹ã«ç§»è¡Œã™ã‚‹ã€‚
3. ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ãƒ»ä¿®æ­£ã™ã‚‹:
   - `backend/app/infrastructure/persistence/models/masters_models.py` (Class `ProductMapping`)
   - `backend/app/presentation/api/routes/masters/product_mappings_router.py`
   - `backend/app/application/services/masters/product_mappings_service.py`
   - `backend/app/presentation/schemas/masters/masters_schema.py`
   - ãã®ä»– Import/Export é–¢é€£
4. ãƒ†ã‚¹ãƒˆã‚’ä¿®æ­£ã™ã‚‹ã€‚

**å…ƒ:** 2026-01-31 ãƒã‚¹ã‚¿ãƒšãƒ¼ã‚¸æ”¹ä¿®


## 5. ãƒ†ã‚¹ãƒˆãƒ»è‡ªå‹•åŒ–

**ğŸ“š å‚è€ƒè³‡æ–™:**
- [Testing Strategy](./TESTING_STRATEGY.md) - è©³ç´°ãªãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã¨ãƒ†ã‚¹ãƒˆãƒ”ãƒ©ãƒŸãƒƒãƒ‰
- [Testing Quick Start Guide](./TESTING_QUICKSTART.md) - ä»Šã™ãä½¿ãˆã‚‹ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¬ã‚¤ãƒ‰

### 5-1. çµ±åˆãƒ†ã‚¹ãƒˆãƒ»E2Eãƒ†ã‚¹ãƒˆã®æ‹¡å……

**å„ªå…ˆåº¦**: High
**ä½œæˆ**: 2026-01-30
**æ›´æ–°**: 2026-02-05ï¼ˆSmartRead/Excel View/ãƒã‚¹ã‚¿å‘¨ã‚Šã®ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆè¿½åŠ å®Œäº†ï¼‰
**ã‚«ãƒ†ã‚´ãƒª**: å“è³ªä¿è¨¼ãƒ»å›å¸°ãƒ†ã‚¹ãƒˆ

**èƒŒæ™¯:**
æ˜¨æ—¥ã®å¤§è¦æ¨¡æ”¹ä¿®ï¼ˆPhase 2ç§»è¡Œï¼‰å¾Œã€æ‰‹å‹•ãƒ†ã‚¹ãƒˆã§ä»¥ä¸‹ã®500ã‚¨ãƒ©ãƒ¼ãŒç™ºè¦‹ã•ã‚Œã¾ã—ãŸã€‚ã“ã‚Œã‚‰ã¯ãƒ†ã‚¹ãƒˆã§æ¤œå‡ºã•ã‚Œãšã€æœ¬ç•ªç›¸å½“ã®ç’°å¢ƒã§åˆã‚ã¦ç™ºè¦šã—ã¾ã—ãŸï¼š

1. **å˜ä½æ›ç®—ãƒšãƒ¼ã‚¸**: SQLAlchemy joinæ§‹æ–‡ãƒŸã‚¹
2. **ä¸€æ‹¬ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**: Pythonã‚¹ã‚³ãƒ¼ãƒ—ãƒ«ãƒ¼ãƒ«é•åï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã®é‡è¤‡ï¼‰
3. **ææ–™ãƒ­ãƒƒãƒˆç®¡ç†ãƒšãƒ¼ã‚¸**: `lot_number` NULL/ç©ºæ–‡å­—åˆ—ã®Pydanticãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼

**èª²é¡Œ:**
- ä¸»è¦APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®çµ±åˆãƒ†ã‚¹ãƒˆãŒä¸è¶³
- ç”»é¢é·ç§»ãƒ»UIæ“ä½œã‚’å«ã‚€E2Eãƒ†ã‚¹ãƒˆãŒå­˜åœ¨ã—ãªã„
- ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã«å¢ƒç•Œå€¤ã‚±ãƒ¼ã‚¹ï¼ˆNULLå€¤ãªã©ï¼‰ãŒä¸è¶³

**ã‚¿ã‚¹ã‚¯å†…å®¹:**

#### 5-1-1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰çµ±åˆãƒ†ã‚¹ãƒˆã®è¿½åŠ 
- [ ] ä¸»è¦APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆå®Ÿéš›ã®DBæ¥ç¶šï¼‰
  - ãƒã‚¹ã‚¿ç³»: é¡§å®¢ã€è£½å“ã€ä»•å…¥å…ˆã€å€‰åº«ã€å˜ä½æ›ç®—ã€etc.
  - ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç³»: ãƒ­ãƒƒãƒˆã€å—æ³¨ã€å¼•å½“ã€å…¥å‡ºåº«
  - ã‚·ã‚¹ãƒ†ãƒ ç³»: ä¸€æ‹¬ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€ãƒ­ã‚°ãƒ“ãƒ¥ãƒ¼ã‚¢
- [ ] ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ãƒ»å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆ
  - NULLè¨±å®¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ãƒ†ã‚¹ãƒˆ
  - ç©ºæ–‡å­—åˆ—ã€ã‚¼ãƒ­å€¤ã®ãƒ†ã‚¹ãƒˆ
  - å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„é•åã®ãƒ†ã‚¹ãƒˆ
- [ ] SQLã‚¯ã‚¨ãƒªã®ãƒ†ã‚¹ãƒˆ
  - JOINæ§‹æ–‡ã®æ­£å½“æ€§
  - N+1å•é¡Œã®æ¤œå‡º
  - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

#### 5-1-2. E2Eãƒ†ã‚¹ãƒˆåŸºç›¤ã®æ§‹ç¯‰
- [x] E2Eãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®é¸å®šãƒ»å°å…¥ï¼ˆPlaywrightï¼‰
- [x] **ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆè¿½åŠ å®Œäº†ï¼ˆ2026-02-05ï¼‰**
  - `frontend/e2e/specs/smoke/smartread-smoke.spec.ts` - SmartReadãƒšãƒ¼ã‚¸è¡¨ç¤ºç¢ºèª
  - `frontend/e2e/specs/smoke/excel-view-smoke.spec.ts` - Excel Viewãƒšãƒ¼ã‚¸è¡¨ç¤ºç¢ºèª
  - `frontend/e2e/specs/smoke/masters-smoke.spec.ts` - ãƒã‚¹ã‚¿ãƒšãƒ¼ã‚¸è¡¨ç¤ºç¢ºèª
  - å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰: `make test-smoke` (30ç§’)
- [x] **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰çµ±åˆãƒ†ã‚¹ãƒˆè¿½åŠ **
  - `backend/tests/integration/test_smartread_integration.py` - SmartRead OCR â†’ æ³¨æ–‡ç”Ÿæˆãƒ•ãƒ­ãƒ¼
- [ ] [P0] E2Eãƒ†ã‚¹ãƒˆã®æ°¸ç¶šåŒ–æ¤œè¨¼å¤±æ•—ã®èª¿æŸ»ã¨ä¿®æ­£
    - çŠ¶æ³: `e2e-02` ãƒ†ã‚¹ãƒˆã§ä¿å­˜APIè‡ªä½“ãŒãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰é€ä¿¡ã•ã‚Œã¦ã„ãªã„ç¾è±¡ã‚’ç¢ºèªã€‚
    - åŸå› èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ: [e2e_persistence_failure_report.md](../investigation/e2e_persistence_failure_report.md)
    - [x] ä¸¦åˆ—å®Ÿè¡Œæ™‚ã®DBãƒªã‚»ãƒƒãƒˆå¹²æ¸‰ (`e2e-04`) ã¯ä¿®æ­£æ¸ˆã¿ã€‚
- [ ] **ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆã®è¿½åŠ ï¼ˆTODOï¼‰**
  - SmartRead: OCRç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ æ³¨æ–‡ç”Ÿæˆã®å®Œå…¨ãƒ•ãƒ­ãƒ¼
  - ãƒã‚¹ã‚¿CRUD: å•†å“ãƒã‚¹ã‚¿ä½œæˆ â†’ åœ¨åº«ç™»éŒ²ã§ã®ä½¿ç”¨
  - Excel View: ãƒ•ã‚£ãƒ«ã‚¿/ã‚½ãƒ¼ãƒˆ â†’ ã‚»ãƒ«ç·¨é›† â†’ ä¿å­˜
- [ ] ä¸»è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ­ãƒ¼
  - ãƒ­ã‚°ã‚¤ãƒ³ â†’ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ â†’ ãƒã‚¹ã‚¿ç”»é¢é·ç§»
  - ãƒ­ãƒƒãƒˆæ–°è¦ç™»éŒ² â†’ åœ¨åº«ç¢ºèª
  - å—æ³¨ç™»éŒ² â†’ å¼•å½“ â†’ å‡ºåº«
  - ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- [ ] ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒ‘ã‚¹ã®ãƒ†ã‚¹ãƒˆ
  - FEFOå¼•å½“ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
  - åœ¨åº«è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
  - æ¨©é™åˆ¶å¾¡ï¼ˆRBACï¼‰

#### 5-1-3. ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®æ‹¡å……
- [ ] å¢ƒç•Œå€¤ãƒ»ç•°å¸¸ç³»ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿è¿½åŠ 
  - `lot_number` ãŒ NULL/ç©ºæ–‡å­—åˆ—ã®ãƒ­ãƒƒãƒˆ
  - æ¶ˆè²»æœŸé™åˆ‡ã‚Œã®ãƒ­ãƒƒãƒˆ
  - è«–ç†å‰Šé™¤ã•ã‚ŒãŸãƒã‚¹ã‚¿ã‚’å‚ç…§ã™ã‚‹ãƒ‡ãƒ¼ã‚¿
- [ ] `factory_boy` ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã®è‡ªå‹•åŒ–

**æƒ³å®šå·¥æ•°**: 1-2é€±é–“ï¼ˆæ®µéšçš„ã«å®Ÿè£…ï¼‰

**å…ƒ:** 2026-01-30 æ‰‹å‹•ãƒ†ã‚¹ãƒˆçµæœã®ãƒ¬ãƒ“ãƒ¥ãƒ¼

---

### 5-2. ãƒ†ã‚¹ãƒˆåŸºç›¤æ‹¡å¼µï¼ˆä½å„ªå…ˆåº¦ï¼‰

- **C3: Data Factory (Backend) æ‹¡å¼µ**: `factory_boy` ç­‰ã‚’ä½¿ç”¨ã—ãŸãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆãƒ•ã‚¡ã‚¯ãƒˆãƒªã®æ•´å‚™ã€‚ç¾åœ¨ã¯ `services/test_data_generator.py` ã§ä»£ç”¨ä¸­ã€‚
- **C4: Test Matrix å®šç¾©**: ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®çµ„ã¿åˆã‚ã›è¡¨ï¼ˆãƒãƒˆãƒªã‚¯ã‚¹ï¼‰ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ã¨ç®¡ç†ã€‚
- **Phase D: APIçµ±åˆãƒ†ã‚¹ãƒˆæ‹¡å¼µ**: ä»¥ä¸‹ã®è¦³ç‚¹ã§ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰çµ±åˆãƒ†ã‚¹ãƒˆæ‹¡å……ã€‚
  - ä¸»è¦ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£CRUDï¼ˆæ­£å¸¸ç³»/ç•°å¸¸ç³»ï¼‰
  - ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒ†ã‚¹ãƒˆï¼ˆãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¢ƒç•Œãªã©ï¼‰
  - æ¨©é™ãƒ†ã‚¹ãƒˆï¼ˆRBACã®å¾¹åº•ç¢ºèªï¼‰

**å…ƒ:** `backlog.md::5-1` (2026-01-18)

---

### 5-3. ãƒ†ã‚¹ãƒˆDBã§Alembic Migrationsã‚’å®Ÿè¡Œ

**å„ªå…ˆåº¦**: Medium
**é›£æ˜“åº¦**: Medium
**æƒ³å®šå·¥æ•°**: 2-3æ—¥

**èƒŒæ™¯:**
ç¾åœ¨ã€ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ã¯ `Base.metadata.create_all()` ã§ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¦ã„ã‚‹ãŸã‚ã€æœ¬ç•ªç’°å¢ƒï¼ˆAlembic Migrationsä½¿ç”¨ï¼‰ã¨ä»¥ä¸‹ã®å·®ç•°ãŒç™ºç”Ÿã—ã¾ã™ï¼š

1. **server_defaultå€¤ã®é•ã„**
   - ä¾‹: `consumed_quantity` ã‚«ãƒ©ãƒ ã¯ã€ãƒ¢ãƒ‡ãƒ«å®šç¾©ã§ã¯ `server_default=text("0")` ã ãŒã€Migrationã§ã¯ `server_default=None`
2. **Database Triggersã®æœªé©ç”¨**
3. **Constraintsã®é•ã„**
4. **Migrationè‡ªä½“ã®ãƒã‚°æ¤œå‡ºä¸å¯**

**å•é¡Œç‚¹ (2026-01-18æ™‚ç‚¹):**
- ç¾åœ¨70+ migrationsãŒå­˜åœ¨ã—ã€å¤šæ•°ã®mergepoint/branchpointãŒã‚ã‚‹
- ä¾å­˜é–¢ä¿‚ãŒè¤‡é›‘ã§ã€ãƒ†ãƒ¼ãƒ–ãƒ«ãŒæ­£ã—ã„é †åºã§ä½œæˆã•ã‚Œãªã„

**å®Ÿè£…ã‚¿ã‚¤ãƒŸãƒ³ã‚°:**
ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã®æ¡ä»¶ã‚’æº€ãŸã—ãŸæ™‚ç‚¹ã§å®Ÿè£…ï¼š
1. Migrationã®çµ±åˆãƒ»æ•´ç†ãŒå®Œäº†ï¼ˆ70+ â†’ 10-20å€‹ç¨‹åº¦ï¼‰
2. ã‚¹ã‚­ãƒ¼ãƒã®å¤§å¹…å¤‰æ›´æ™‚
3. Migrationé–¢é€£ã®ãƒã‚°ãŒé »ç™º

**æš«å®šå¯¾ç­–ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰:**
1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã§ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤è¨­å®š
2. ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®ä¿®æ­£
3. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–

**å…ƒ:** `FUTURE_IMPROVEMENTS.md`

---





### 5-5. E2Eãƒ†ã‚¹ãƒˆã®å¤±æ•—ä¿®æ­£ (19ä»¶)

**å„ªå…ˆåº¦**: Medium
**ä½œæˆ**: 2026-01-26
**ç¾çŠ¶**: 61ãƒ†ã‚¹ãƒˆä¸­ 42 passed / 19 failed

**å¤±æ•—ã‚«ãƒ†ã‚´ãƒª:**

1. **ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ã‚»ãƒ¬ã‚¯ã‚¿å•é¡Œ** (è¤‡æ•°ãƒ†ã‚¹ãƒˆ)
   - `getByLabel('ãƒ¦ãƒ¼ã‚¶ãƒ¼å')` ãŒè¦‹ã¤ã‹ã‚‰ãªã„
   - å¯¾è±¡: `e2e-04-permission.spec.ts` ç­‰
   - åŸå› : ãƒ­ã‚°ã‚¤ãƒ³UIã®å¤‰æ›´ã«ãƒ†ã‚¹ãƒˆãŒè¿½å¾“ã—ã¦ã„ãªã„

2. **ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆ**
   - `warehouse-crud.spec.ts`: "Existing Warehouse" ãŒå­˜åœ¨ã—ãªã„
   - `customer-items.spec.ts`: æœŸå¾…ã™ã‚‹ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒãªã„

3. **ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ/å¿œç­”é…å»¶**
   - `e2e-06-error-handling.spec.ts`: é•·æ™‚é–“ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

**å¤±æ•—ãƒ†ã‚¹ãƒˆä¸€è¦§:**
- `e2e/allocation.spec.ts`
- `e2e/customer-items.spec.ts`
- `e2e/rpa-material-delivery.spec.ts`
- `e2e/shortage-auto-order.spec.ts`
- `e2e/specs/p0/e2e-01-order-flow.spec.ts`
- `e2e/specs/p0/e2e-02-save-persistence.spec.ts` (2ä»¶)
- `e2e/specs/p0/e2e-03-double-submit.spec.ts` (2ä»¶)
- `e2e/specs/p0/e2e-04-permission.spec.ts` (4ä»¶)
- `e2e/specs/p0/e2e-05-list-filter.spec.ts` (4ä»¶)
- `e2e/specs/p0/e2e-06-error-handling.spec.ts`
- `e2e/warehouse-crud.spec.ts`

**å¯¾å¿œæ–¹é‡:**
1. ãƒ­ã‚°ã‚¤ãƒ³ã‚»ãƒ¬ã‚¯ã‚¿ã‚’ç¾åœ¨ã®UIæ§‹é€ ã«åˆã‚ã›ã¦æ›´æ–°
2. ãƒ†ã‚¹ãƒˆãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£/ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã®æ•´å‚™
3. ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå€¤ã®èª¿æ•´ã¾ãŸã¯ãƒ†ã‚¹ãƒˆè¨­è¨ˆã®è¦‹ç›´ã—

**å…ƒ:** SSOTåŒ–PR E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œçµæœ (2026-01-26)

---

## 6. æ©Ÿèƒ½æ”¹å–„ãƒ»ä¸­é•·æœŸã‚¿ã‚¹ã‚¯

### 6-1. DB/UIæ•´åˆæ€§ä¿®æ­£ã«ä¼´ã†ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½

- Forecasts / Orders / Inventory/Lots ã® Excel ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå®Ÿè£…ã€‚

**å…ƒ:** `backlog.md::6-1` (2026-01-18)

---

### 6-2. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®å¯è¦–åŒ–ï¼ˆrechartsï¼‰

- KPIã®ã¿ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã‚°ãƒ©ãƒ•ã‚’è¿½åŠ ã€‚

**å…ƒ:** `backlog.md::6-2` (2026-01-18)

---

### 6-3. SAPé€£æºã‚¿ã‚¹ã‚¯

- æœ¬ç•ªAPIæ¥ç¶šã€äºŒé‡è¨ˆä¸Šé˜²æ­¢ã®ã¹ãç­‰æ€§å¯¾å¿œã€åœ¨åº«åŒæœŸã€‚

**å…ƒ:** `backlog.md::6-3` (2026-01-18)

---

### 6-4. ãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆå˜ä½ã®å¼•å½“æ¨å¥¨ç”Ÿæˆ

- æ—¢å­˜ã¯å…¨æœŸé–“ä¸€æ‹¬ã®ã¿ã€‚ãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆã‚°ãƒ«ãƒ¼ãƒ—å˜ä½ã§ã®ç”ŸæˆãŒå¿…è¦ã€‚

**å…ƒ:** `backlog.md::6-4` (2026-01-18)

---

### 6-5. å…¥è·äºˆå®šã®å€‰åº«ãƒ‡ãƒ¼ã‚¿å–å¾—æ”¹å–„

- `InboundPlan`ãƒ˜ãƒƒãƒ€ãƒ¼ã«å€‰åº«æƒ…å ±ãŒãªãã€ŒæœªæŒ‡å®šã€ã«é›†ç´„ã•ã‚Œã‚‹å•é¡Œã€‚

**å…ƒ:** `backlog.md::6-5` (2026-01-18)

---

### 6-6. OpenAPIå‹å®šç¾©ã®å°å…¥

- `openapi-typescript` ã‚’åˆ©ç”¨ã—ãŸå‹ç”Ÿæˆã§ãƒ•ãƒ­ãƒ³ãƒˆ/ãƒãƒƒã‚¯ã®æ•´åˆæ€§ã‚’ç¢ºä¿ã€‚

**å…ƒ:** `backlog.md::6-6` (2026-01-18)

---

### 6-7. å•†å“è­˜åˆ¥è¨­è¨ˆã®ãƒ“ã‚¸ãƒã‚¹å®Ÿæ…‹ã¸ã®é©åˆ

**å„ªå…ˆåº¦**: Medium
**é›£æ˜“åº¦**: High
**æƒ³å®šå·¥æ•°**: 5-7æ—¥

**èƒŒæ™¯ãƒ»èª²é¡Œ:**
- ç¾çŠ¶ã®å®Ÿè£…ã¯ `maker_part_code`ï¼ˆãƒ¡ãƒ¼ã‚«ãƒ¼å“ç•ª/å†…éƒ¨ã‚³ãƒ¼ãƒ‰ï¼‰ä¸­å¿ƒã ãŒã€ãƒ“ã‚¸ãƒã‚¹å®Ÿæ…‹ã¯9å‰²ãŒã€Œå…ˆæ–¹å“ç•ªï¼ˆCustomer Part Noï¼‰ã€ãƒ™ãƒ¼ã‚¹ã§ã‚ã‚‹ã€‚
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç›´æ„Ÿã«åˆã‚ã›ãŸè­˜åˆ¥å­è¨­è¨ˆã¸ã®è¦‹ç›´ã—ãŒå¿…è¦ã€‚

**ã‚¿ã‚¹ã‚¯å†…å®¹:**
1. å…ˆæ–¹å“ç•ªã‚’ãƒ—ãƒ©ã‚¤ãƒãƒªãªæ¤œç´¢/è­˜åˆ¥ã‚­ãƒ¼ã¨ã—ã¦æ‰±ãˆã‚‹ã‚ˆã†è¨­è¨ˆã‚’è¦‹ç›´ã™ã€‚
2. `Product` ãƒã‚¹ã‚¿ã«ãŠã‘ã‚‹è¤‡æ•°å“ç•ªï¼ˆãƒ¡ãƒ¼ã‚«ãƒ¼å“ç•ªã€å…ˆæ–¹å“ç•ªã€å†…éƒ¨ã‚³ãƒ¼ãƒ‰ï¼‰ã®å„ªå…ˆé †ä½ã¨ç”¨é€”ã‚’æ•´ç†ã—ã€å‘½åã‚’æ”¹å–„ã™ã‚‹ã€‚

**é–¢é€£:** `MASTER_DATA_FIELD_ALIGNMENT_TASKS.md::4`

**å…ƒ:** `FUTURE_IMPROVEMENTS.md` & `MASTER_DATA_FIELD_ALIGNMENT_TASKS.md` (2026-01-19)

---

### 6-8. Phase 4ä»¥é™ï¼šå°†æ¥çš„ãªæ”¹å–„ãƒ»æ‹¡å¼µ

**å„ªå…ˆåº¦**: Lowã€œMedium
**é›£æ˜“åº¦**: Mediumã€œHigh

**ã‚¿ã‚¹ã‚¯å†…å®¹:**
1. **ãƒãƒƒãƒ”ãƒ³ã‚°è¨­å®šã®UIåŒ–**
   - ç¾åœ¨ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã§è¡Œã£ã¦ã„ã‚‹OCRãƒ†ã‚­ã‚¹ãƒˆç½®æ›ã‚„å“ç›®ãƒãƒƒãƒ”ãƒ³ã‚°ã®è¨­å®šã‚’ã€ç®¡ç†ç”¨UIã‹ã‚‰å¤‰æ›´å¯èƒ½ã«ã™ã‚‹ã€‚
2. **AIã‚’æ´»ç”¨ã—ãŸè£œå®Œæ©Ÿèƒ½**
   - éå»ã®ç·¨é›†å±¥æ­´ã‚’æ•™å¸«ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦å­¦ç¿’ã—ã€OCRçµæœã®ä¸æ˜ç­ãªç®‡æ‰€ã‚’ã‚ˆã‚Šé«˜ã„ç²¾åº¦ã§è‡ªå‹•è£œå®Œã™ã‚‹ã€‚
3. **ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ©Ÿèƒ½**
   - ãƒ­ãƒƒãƒˆç®¡ç†çŠ¶æ³ã‚„OCRå‡¦ç†é€Ÿåº¦ã€ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿç‡ãªã©ã‚’è¦–è¦šåŒ–ã™ã‚‹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®è¿½åŠ ã€‚
4. **OCRçµæœã¨å—æ³¨ç®¡ç†ã®çµ±åˆ**
   - OCRã§èª­ã¿å–ã£ãŸçµæœã‚’å—æ³¨ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ç›´æ¥å–ã‚Šè¾¼ã¿ã€å—æ³¨ç®¡ç†æ©Ÿèƒ½ã¨ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«é€£æºã•ã›ã‚‹ã“ã¨ã§ã€å…¥åŠ›ä½œæ¥­ã®ã•ã‚‰ãªã‚‹è‡ªå‹•åŒ–ã‚’å›³ã‚‹ã€‚
5. **scripts ã¨ tools ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ•´ç†ãƒ»å®šç¾©æ˜ç¢ºåŒ–**
   - ç¾åœ¨ã€é‹ç”¨ç³»ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆscriptsï¼‰ã¨é–‹ç™ºãƒ»CIãƒ„ãƒ¼ãƒ«ï¼ˆtoolsï¼‰ã®å¢ƒç•ŒãŒæ›–æ˜§ãªãŸã‚ã€å½¹å‰²ã‚’å†å®šç¾©ã—ã¦æ•´ç†ã™ã‚‹ã€‚
   - `scripts`: æœ¬ç•ª/ãƒ†ã‚¹ãƒˆç’°å¢ƒã®ãƒ‡ãƒ¼ã‚¿è£œæ­£ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã€ãƒ‡ãƒ—ãƒ­ã‚¤ãªã©ã®é‹ç”¨ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ç³»ã€‚
   - `tools`: é™çš„è§£æã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè‡ªå‹•ç”Ÿæˆã€é–‹ç™ºè£œåŠ©ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãªã©ã®é–‹ç™ºãƒ»CIç³»ã€‚
6. **DBæ•´åˆæ€§ç¶­æŒã®è‡ªå‹•åŒ– (DB Triggers)**
   - `lot_master` ã®é›†è¨ˆå€¤ï¼ˆåˆå›å…¥è·æ—¥ã€æœ€çµ‚æœ‰åŠ¹æœŸé™ç­‰ï¼‰ã‚’DBãƒˆãƒªã‚¬ãƒ¼ã§è‡ªå‹•æ›´æ–°ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã§ã®æ›´æ–°æ¼ã‚Œã‚’é˜²ãã€‚

**å…ƒ:** `FUTURE_IMPROVEMENTS.md`

---

## 7. ã‚³ãƒ¼ãƒ‰å“è³ªãƒ»ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º

### 7-1. ãƒ†ã‚¹ãƒˆã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¤œå‡ºã¨ä¿®æ­£

**å„ªå…ˆåº¦**: Medium
**ä½œæˆ**: 2026-01-30
**ã‚«ãƒ†ã‚´ãƒª**: ã‚³ãƒ¼ãƒ‰å“è³ªãƒ»ä¿å®ˆæ€§

**èƒŒæ™¯:**
ãƒ†ã‚¹ãƒˆä¿®æ­£ä¸­ã«ã€è¤‡æ•°ã®ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ãŒç™ºè¦‹ã•ã‚Œã¾ã—ãŸï¼š
1. **ç‹¬è‡ªtest_dbã‚»ãƒƒã‚·ãƒ§ãƒ³**: 21å€‹ã®APIãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒç‹¬è‡ªã®DBã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«fixtureã¨äº’æ›æ€§ãŒãªã„
2. **fixture ã®é‡è¤‡**: åŒã˜ master data ã‚’å„ãƒ•ã‚¡ã‚¤ãƒ«ã§é‡è¤‡ã—ã¦å®šç¾©
3. **ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†ã®ä¸çµ±ä¸€**: commit/flush/rollback ã®ä½¿ã„åˆ†ã‘ãŒçµ±ä¸€ã•ã‚Œã¦ã„ãªã„

**ã‚¿ã‚¹ã‚¯å†…å®¹:**

#### 7-1-1. æ—¢çŸ¥ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¿®æ­£
- [x] ç‹¬è‡ªtest_dbã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å‰Šé™¤ï¼ˆ21ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰â†’ ã‚°ãƒ­ãƒ¼ãƒãƒ« `db` fixture ã«çµ±ä¸€ (ARCHIVE.mdã¸ç§»å‹•)

#### 7-1-2. ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºãƒ„ãƒ¼ãƒ«ã®å°å…¥
- [ ] pytest-best-practices ãªã©ã®linterãƒ„ãƒ¼ãƒ«æ¤œè¨
- [ ] ã‚«ã‚¹ã‚¿ãƒ pytest pluginã§ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º
  - ç‹¬è‡ªã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆã®æ¤œå‡º
  - fixture ã‚¹ã‚³ãƒ¼ãƒ—ã®ä¸é©åˆ‡ãªä½¿ç”¨
  - é‡è¤‡ã™ã‚‹setup/teardown
- [ ] CI/CDã«çµ„ã¿è¾¼ã¿

#### 7-1-3. ãƒ†ã‚¹ãƒˆãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–
- [ ] `docs/standards/testing.md` ã®ä½œæˆ
  - Fixture ã®ä½¿ã„æ–¹
  - ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†
  - ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ä½œæˆãƒ‘ã‚¿ãƒ¼ãƒ³
  - é¿ã‘ã‚‹ã¹ãã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³

**æƒ³å®šå·¥æ•°**: 2-3æ—¥

**å…ƒ:** 2026-01-30 ãƒ†ã‚¹ãƒˆä¿®æ­£ä½œæ¥­

---

## 9. ä¿ç•™ï¼ˆå†ç¾ç¢ºèªãƒ»èª¿æŸ»å¾…ã¡ï¼‰

### 9-1. ãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆç·¨é›†å¾Œã®æ›´æ–°å•é¡Œ

- ãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆç·¨é›†å¾Œã€è¨ˆç”»å¼•å½“ã‚µãƒãƒªãƒ»é–¢é€£å—æ³¨ãŒæ›´æ–°ã•ã‚Œãªã„ã€‚
- æ‰‹å‹•ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã§ã¯å›é¿å¯èƒ½ã€‚ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å†è¨ˆç®—ã®ç¢ºèªãŒå¿…è¦ã€‚

**å…ƒ:** `backlog.md::7-1` (2026-01-18)

---

### 9-2. éå»ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–æ€§å‘ä¸Š

- **å…¥è·äºˆå®šä¸€è¦§**: éå»ãƒ‡ãƒ¼ã‚¿ã®è¡¨ç¤ºç¢ºèªã¨ã€Œéå»/æœªæ¥ã€ã‚¿ãƒ–ã¾ãŸã¯ãƒ•ã‚£ãƒ«ã‚¿ã®å®Ÿè£…ã€‚
- **å—æ³¨ç®¡ç†**: éå»ã®å—æ³¨ãƒ‡ãƒ¼ã‚¿ã®è¡¨ç¤ºç¢ºèªã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹/æ—¥ä»˜ãƒ•ã‚£ãƒ«ã‚¿ã®å¼·åŒ–ã€‚
- **ãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆä¸€è¦§**: ã€Œå±¥æ­´ã€ã‚¿ãƒ–ã®æ©Ÿèƒ½ç¢ºèªã¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…ï¼ˆ`/history`ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæ´»ç”¨ï¼‰ã€‚

**å…ƒ:** `backlog.md::8-1` (2026-01-18)

---

### 9-3. RPAé€šå¸¸ç‰ˆ (Step1) ã®å®Ÿè¡Œä¸å¯ä¿®æ­£

- **ç—‡çŠ¶**: `/rpa/material-delivery-note` ã®Step1å®Ÿè¡Œãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚‚ã€è¨­å®šã‚­ãƒ¼ä¸ä¸€è‡´ã«ã‚ˆã‚ŠBackendã§å³åº§ã«ã‚¨ãƒ©ãƒ¼ã¨ãªã‚‹ã€‚
- **åŸå› **: Frontend (`STEP1_URL`) ã¨ Backend (`progress_download_url`) ã®è¨­å®šã‚­ãƒ¼ä¸æ•´åˆã€‚
- **å¯¾å‡¦**: è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ«ã®ä¿å­˜ã‚­ãƒ¼ä¿®æ­£ã€ã¾ãŸã¯Backendã®å‚ç…§ã‚­ãƒ¼ä¿®æ­£ã€‚
- **è©³ç´°**: `docs/issues/20260128_RPA_MaterialDelivery_Step1_Failure.md`

**å…ƒ:** 2026-01-28 èª¿æŸ»

---

## 9. æŠ€è¡“è² å‚µ (ä½å„ªå…ˆåº¦)

### 9-1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: å¤–éƒ¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å‹å®šç¾©ã‚’æ”¹å–„

**å„ªå…ˆåº¦**: Low (anyå‹å‰Šæ¸› Phase 3)
**å¯¾è±¡**: 16ç®‡æ‰€

**å ´æ‰€**: `src/types/external-modules.d.ts`

**ç†ç”±**: å¤–éƒ¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«(@radix-ui)ã®å‹å®šç¾©ãŒä¸å®Œå…¨

**å¯¾å¿œ**: Radix UIã®å‹å®šç¾©ã‚’æ­£ç¢ºã«è¨˜è¿°ã™ã‚‹ã‹ã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£å‹å®šç¾©ã‚’åˆ©ç”¨

**å…ƒ:** `any-type-reduction.md` (2026-01-18)

---

### 9-2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: Repository Methodsã«ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã‚’å°å…¥

**å„ªå…ˆåº¦**: Low (anyå‹å‰Šæ¸› Phase 3)
**å¯¾è±¡**: 3ç®‡æ‰€

**å ´æ‰€**: `app/infrastructure/persistence/repositories/rpa_repository.py`

**ç¾çŠ¶:**
```python
def add(self, entity: Any) -> None:
    self.db.add(entity)

def refresh(self, entity: Any) -> None:
    self.db.refresh(entity)
```

**å¯¾å¿œ**: ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã‚’ä½¿ç”¨
```python
from typing import TypeVar
T = TypeVar('T')

def add(self, entity: T) -> None:
    self.db.add(entity)
```

**å…ƒ:** `any-type-reduction.md` (2026-01-18)

---

### 9-3. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: Export Serviceã®å‹ã‚’æ”¹å–„

**å„ªå…ˆåº¦**: Low (anyå‹å‰Šæ¸› Phase 3)
**å¯¾è±¡**: 2ç®‡æ‰€

**å ´æ‰€**: `app/application/services/common/export_service.py`

**å¯¾å¿œ**: TypedDictã¾ãŸã¯ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨

**å…ƒ:** `any-type-reduction.md` (2026-01-18)

---

### 9-4. SmartRead Logging Gaps - errorLogger Integration

**å„ªå…ˆåº¦**: Medium
**ä½œæˆ**: 2026-01-21
**é–¢é€£PR**: feature/smartread-vertical-conversion-fix

**èƒŒæ™¯:**
PR #454 added `errorLogger` to main features for success/error logging. However, SmartRead feature lacks consistent logging across all operations.

**å®Œäº†æ¸ˆã¿:**
- `useTransformToLong` - errorLoggerè¿½åŠ æ¸ˆã¿

**æ¬ è½ç®‡æ‰€:**
- API Operations (`api.ts`): `syncTaskResults()`, `saveLongData()`, `uploadFile()`, etc.
- Hook Operations (`hooks.ts`): `useSyncTaskResults`, `useSmartReadConfigs`, `useSmartReadTasks`
- Component Operations: `SmartReadResultView`, `SmartReadUploadPanel`, `SmartReadTaskList`

**å„ªå…ˆåº¦:**
- High: `useSyncTaskResults`, API file operations, config CRUD
- Medium: User action logging, task list operations
- Low: Backend logging strategy review

**å…ƒ:** `smartread-logging-gaps.md` (2026-01-21)

---

### 9-5. SmartRead Cache-to-DB Save Inconsistency

**å„ªå…ˆåº¦**: Medium
**ä½œæˆ**: 2026-01-21

**å•é¡Œ:**
ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ï¼ˆIndexedDBï¼‰ãŒè‡ªå‹•çš„ã«DBã«ä¿å­˜ã•ã‚Œãªã„ãŸã‚ã€ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šæ€§ãŒä¿è¨¼ã•ã‚Œã¦ã„ãªã„ã€‚

**æ¨å¥¨å¯¾å¿œï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³Cï¼‰:**
IDBã«ã€ŒDBä¿å­˜æ¸ˆã¿ã€ãƒ•ãƒ©ã‚°ã‚’è¿½åŠ ã—ã€æœªä¿å­˜ãƒ‡ãƒ¼ã‚¿ã®ã¿DBä¿å­˜ã™ã‚‹ã€‚

**å®Ÿè£…ã‚¿ã‚¹ã‚¯:**
1. ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ï¼ˆ`saved_to_db` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ ï¼‰
2. ä¿å­˜ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…
3. ä»–ã®ãƒ•ãƒ­ãƒ¼ä¿®æ­£
4. ãƒ†ã‚¹ãƒˆ

**å…ƒ:** `smartread-cache-db-save-inconsistency.md` (2026-01-21)

---

### 9-6. SSOTçµ±ä¸€: CustomerItems è¤‡åˆã‚­ãƒ¼APIå»ƒæ­¢

**å„ªå…ˆåº¦**: Low
**ä½œæˆ**: 2026-01-26
**é–¢é€£**: customer_item_delivery_settings SSOTåŒ–

**èƒŒæ™¯:**
CustomerItemsã®CRUD APIã¯ç¾åœ¨ã€å¾Œæ–¹äº’æ›æ€§ã®ãŸã‚`/{customer_id}/{customer_part_no}`å½¢å¼ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ç¶­æŒã—ã¦ã„ã‚‹ã€‚
`customer_items.id`ãŒSSOTã§ã‚ã‚‹ãŸã‚ã€å°†æ¥çš„ã«`/{id}`ãƒ™ãƒ¼ã‚¹ã«çµ±ä¸€ã™ã¹ãã€‚

**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«:**
- `backend/app/presentation/api/routes/masters/customer_items_router.py`
- `backend/app/application/services/masters/customer_items_service.py`

**å»ƒæ­¢å¯¾è±¡ãƒ¡ã‚½ãƒƒãƒ‰:**
- `get_by_key(customer_id, customer_part_no)`
- `update_by_key(customer_id, customer_part_no, ...)`
- `delete_by_key(customer_id, customer_part_no, ...)`
- `restore_by_key(customer_id, customer_part_no)`
- `permanent_delete_by_key(customer_id, customer_part_no)`

**ç§»è¡Œæ‰‹é †:**
1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®å‘¼ã³å‡ºã—å…ƒã‚’`/{id}`å½¢å¼ã«ç§»è¡Œ
2. å¾Œæ–¹äº’æ›ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«deprecationè­¦å‘Šã‚’è¿½åŠ 
3. ä¸€å®šæœŸé–“å¾Œã«å¾Œæ–¹äº’æ›ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å‰Šé™¤

**å…ƒ:** SSOTç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆ (2026-01-26)

---

### 9-7. SSOTçµ±ä¸€: ShipmentTextRequest ã® customer_item_id å¯¾å¿œ

**å„ªå…ˆåº¦**: Low
**ä½œæˆ**: 2026-01-26
**ä¾å­˜**: OrderLineãƒ¢ãƒ‡ãƒ«ã¸ã®`customer_item_id`è¿½åŠ 

**èƒŒæ™¯:**
`/shipment-text`ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ç¾åœ¨`customer_id + product_id`ã‚’å—ã‘å–ã‚Šã€å†…éƒ¨ã§`customer_part_no`ã«å¤‰æ›ã—ã¦ã„ã‚‹ã€‚
OrderLineã«`customer_item_id`ãŒè¿½åŠ ã•ã‚Œã‚Œã°ã€ç›´æ¥`customer_item_id`ã‚’å—ã‘å–ã‚‹å½¢å¼ã«ç§»è¡Œå¯èƒ½ã€‚

**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«:**
- `backend/app/presentation/schemas/masters/customer_item_delivery_setting_schema.py` (ShipmentTextRequest)
- `backend/app/application/services/masters/customer_item_delivery_setting_service.py` (get_shipment_text)
- `backend/app/infrastructure/persistence/repositories/customer_item_delivery_setting_repository.py` (find_matching_setting, find_customer_part_no)

**å‰ææ¡ä»¶:**
- OrderLine / order_lines ãƒ†ãƒ¼ãƒ–ãƒ«ã«`customer_item_id`ã‚«ãƒ©ãƒ ã‚’è¿½åŠ 
- å—æ³¨ä½œæˆæ™‚ã«`customer_item_id`ã‚’è¨­å®šã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…

**å…ƒ:** SSOTç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆ (2026-01-26)

---

### 9-8. ã‚¹ã‚­ãƒ¼ãƒé‡è¤‡è§£æ¶ˆ: SupplierItem

**å„ªå…ˆåº¦**: Low
**ä½œæˆ**: 2026-01-26

**èƒŒæ™¯:**
SupplierItemã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«å¯¾ã—ã¦2ç®‡æ‰€ã§ã‚¹ã‚­ãƒ¼ãƒãŒå®šç¾©ã•ã‚Œã¦ãŠã‚Šã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ€§ãŒä½ä¸‹ã—ã¦ã„ã‚‹ã€‚

**é‡è¤‡ç®‡æ‰€:**
- `backend/app/presentation/schemas/masters/supplier_items_schema.py` (SupplierItemBase, Create, Update, Response)
- `backend/app/presentation/schemas/masters/masters_schema.py:321-367` (åŒåã®ã‚¹ã‚­ãƒ¼ãƒç¾¤)

**å¯¾å¿œ:**
1. ã©ã¡ã‚‰ãŒæ­£ã¨ã—ã¦ä½¿ã‚ã‚Œã¦ã„ã‚‹ã‹èª¿æŸ»
2. ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„æ–¹ã‚’å‰Šé™¤ã€ã¾ãŸã¯ç‰‡æ–¹ã‚’ä»–æ–¹ã¸ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã«å¤‰æ›´
3. ã‚¤ãƒ³ãƒãƒ¼ãƒˆå…ƒã‚’çµ±ä¸€

**å…ƒ:** SSOTç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆ (2026-01-26)

---



### 9-11. å¤§è¦æ¨¡ãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ†å‰² (600è¡Œè¶…)

**å„ªå…ˆåº¦**: Medium
**ä½œæˆ**: 2026-01-26

**èƒŒæ™¯:**
CLAUDE.md ã§æ¨å¥¨ã•ã‚Œã‚‹300è¡Œã‚’å¤§å¹…ã«è¶…ãˆã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã€‚
ä¿å®ˆæ€§ãƒ»å¯èª­æ€§ãƒ»ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§ãŒä½ä¸‹ã€‚

**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«:**
| ãƒ•ã‚¡ã‚¤ãƒ« | è¡Œæ•° | åˆ†å‰²æ¡ˆ |
|----------|------|--------|
| `lot_service.py` | 1177 | LotCreationService, LotQueryService, LotUpdateService ã«åˆ†å‰² |
| `smartread_router.py` | 1108 | æ©Ÿèƒ½åˆ¥ã«è¤‡æ•° APIRouter ã«åˆ†å‰² |
| `smartread/client.py` | 935 | SmartReadUploader, SmartReadDownloader, SmartReadParser ã«åˆ†å‰² |
| `forecast_service.py` | 681 | ForecastImportService, ForecastCalculationService ã«åˆ†å‰² |

---

### 9-14. Infrastructure â†’ Service ã®é€†ä¾å­˜è§£æ¶ˆ

**å„ªå…ˆåº¦**: Medium
**ä½œæˆ**: 2026-01-26

**èƒŒæ™¯:**
Infrastructureå±¤ï¼ˆclients/ï¼‰ãŒServiceå±¤ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹ç®‡æ‰€ãŒã‚ã‚‹ã€‚
ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ä¾å­˜é–¢ä¿‚ãŒé€†å‘ãã€‚

**å¯¾è±¡:**
- `backend/app/infrastructure/clients/lot_client.py`
- `backend/app/infrastructure/clients/inventory_client.py`
- `backend/app/infrastructure/clients/order_client.py`

**å¯¾å¿œ:**
1. Factoryãƒ‘ã‚¿ãƒ¼ãƒ³ã§ä¾å­˜æ€§æ³¨å…¥(DI)ã‚’å®Ÿè£…
2. ã¾ãŸã¯ã€clientsã‚’applicationå±¤ã«ç§»å‹•
3. ä¾å­˜é–¢ä¿‚: Presentation â†’ Application â†’ Domain â†’ Infrastructure

---

### 9-15. TODO/FIXME ã‚³ãƒ¡ãƒ³ãƒˆã®æ£šå¸ã—

**å„ªå…ˆåº¦**: Low
**ä½œæˆ**: 2026-01-26

**èƒŒæ™¯:**
ã‚³ãƒ¼ãƒ‰å†…ã«19ä»¶ã®TODO/FIXMEã‚³ãƒ¡ãƒ³ãƒˆãŒå­˜åœ¨ã€‚
å¯¾å¿œãŒå¿…è¦ãªã‚‚ã®ã¨ã€ã‚‚ã¯ã‚„ä¸è¦ãªã‚‚ã®ãŒæ··åœ¨ã—ã¦ã„ã‚‹å¯èƒ½æ€§ã€‚

**ä¸»ãªTODO:**
- `lots_router.py:461` - "Add permission check"ï¼ˆèªè¨¼ä¸å…·åˆã¯è§£æ¶ˆæ¸ˆã€è©³ç´°ãªãƒ­ãƒ¼ãƒ«åˆ¶é™ã¯ä»Šå¾Œæ¤œè¨ï¼‰
- `replenishment_router.py:57` - "Implement persistence"ï¼ˆæ°¸ç¶šåŒ–æœªå®Ÿè£…ï¼‰
- `smartread_router.py:857` - "SSEå®Ÿè£…"ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥æœªå®Ÿè£…ï¼‰
- `confirm.py:237` - "Support configurable expiry margin"ï¼ˆæœ‰åŠ¹æœŸé™ãƒãƒ¼ã‚¸ãƒ³è¨­å®šï¼‰

**å¯¾å¿œ:**
1. å„TODOã‚’BACKLOGã®é©åˆ‡ãªã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ç§»å‹•
2. å¯¾å¿œæ¸ˆã¿/ä¸è¦ãªTODOã¯å‰Šé™¤
3. æ®‹ã™ã¹ãTODOã«ã¯æœŸé™ã‚„ãƒã‚±ãƒƒãƒˆç•ªå·ã‚’ä»˜ä¸

---

### 9-16. InventoryTable å±•é–‹ã‚­ãƒ¼å½¢å¼ã®çµ±ä¸€

**å„ªå…ˆåº¦**: Low
**ä½œæˆ**: 2026-01-26

**èƒŒæ™¯:**
`InventoryTable`ã®è¡Œå±•é–‹ã§ä½¿ç”¨ã™ã‚‹ã‚­ãƒ¼å½¢å¼ãŒ2ç®‡æ‰€ã§ç•°ãªã£ã¦ã„ã‚‹ã€‚
PR #437 ã§`getItemKey`ã«`supplier_id`ã‚’è¿½åŠ ã—ãŸéš›ã€`useInventoryTableLogic`ã®ã‚­ãƒ¼å½¢å¼ã‚’æ›´æ–°ã—å¿˜ã‚ŒãŸã“ã¨ãŒåŸå› ã€‚

ç¾åœ¨ã¯ãƒãƒ³ãƒ‰ãƒ©ãƒ¼å†…ã§å¤‰æ›å‡¦ç†ã‚’è¡Œã„æš«å®šå¯¾å¿œæ¸ˆã¿ã ãŒã€æ ¹æœ¬çš„ã«ã¯ã‚­ãƒ¼å½¢å¼ã‚’çµ±ä¸€ã™ã¹ãã€‚

**ç¾çŠ¶:**
- `getItemKey` (DataTableè¡ŒID): `${supplier_id ?? "all"}-${product_id}-${warehouse_id}` ï¼ˆ3éƒ¨æ§‹æˆï¼‰
- `useInventoryTableLogic.expandedRows`: `${productId}-${warehouseId}` ï¼ˆ2éƒ¨æ§‹æˆï¼‰

**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«:**
- `frontend/src/features/inventory/components/InventoryTable.tsx`
- `frontend/src/features/inventory/hooks/useInventoryTableLogic.ts`

**å¯¾å¿œæ¡ˆ:**
1. `useInventoryTableLogic`ã®ã‚­ãƒ¼å½¢å¼ã‚’3éƒ¨æ§‹æˆã«çµ±ä¸€
2. `toggleRow`, `isRowExpanded`, `fetchLotsForItem`ç­‰ã®ã‚·ã‚°ãƒãƒãƒ£ã«`supplierId`ã‚’è¿½åŠ 
3. ãƒãƒ³ãƒ‰ãƒ©ãƒ¼å†…ã®å¤‰æ›å‡¦ç†ã‚’å‰Šé™¤

---

## 9. ãƒ“ã‚¸ãƒã‚¹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆè£œè¶³ãŒå¿…è¦ãªé …ç›®

ä»¥ä¸‹ã®é …ç›®ã¯ã€ã‚³ãƒ¼ãƒ‰ã«ã€Œæ„å›³ãƒ»èƒŒæ™¯ã€ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã™ã‚‹éš›ã«ã€é–‹ç™ºè€…ã®åˆ¤æ–­ã ã‘ã§ã¯è¨˜è¿°ã§ããªã„é …ç›®ã§ã™ã€‚å¤–éƒ¨ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¾ãŸã¯ãƒ“ã‚¸ãƒã‚¹è¦ä»¶ã®ç¢ºèªãŒå¿…è¦ã§ã™ã€‚

### 9-1. ğŸ”´ æœ€å„ªå…ˆï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®æ ¹å¹¹ï¼‰

#### éå‰°äºˆç´„ï¼ˆã‚ªãƒ¼ãƒãƒ¼ãƒ–ãƒƒã‚­ãƒ³ã‚°ï¼‰ã®è¨±å®¹ç¯„å›²

**ãƒ•ã‚¡ã‚¤ãƒ«**: `stock_calculation.py`, `lot_reservation_service.py`

**è³ªå•:**
1. ã©ã®ç¨‹åº¦ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ–ãƒƒã‚­ãƒ³ã‚°ã¾ã§è¨±å®¹ã™ã‚‹ã®ã‹ï¼Ÿ
2. ã‚ªãƒ¼ãƒãƒ¼ãƒ–ãƒƒã‚­ãƒ³ã‚°æ™‚ã®é‹ç”¨ãƒ•ãƒ­ãƒ¼
3. ãƒªã‚¹ã‚¯ç®¡ç†

#### FEFO vs FIFO ã®ä½¿ã„åˆ†ã‘åŸºæº–

**ãƒ•ã‚¡ã‚¤ãƒ«**: `allocation_policy.py`, è£½å“ãƒã‚¹ã‚¿

**è³ªå•:**
1. è£½å“ã‚«ãƒ†ã‚´ãƒªã”ã¨ã®å…·ä½“çš„ãªé©ç”¨ãƒ«ãƒ¼ãƒ«
2. æœ‰åŠ¹æœŸé™ã®è¨­å®šåŸºæº–
3. é¡§å®¢è¦æ±‚ã¸ã®å¯¾å¿œ

#### SAPé€£æºã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¨è²¬ä»»ç¯„å›²

**ãƒ•ã‚¡ã‚¤ãƒ«**: `sap_service.py`, `sap_router.py`

**è³ªå•:**
1. SAPç™»éŒ²ã®ãƒˆãƒªã‚¬ãƒ¼
2. SAPç™»éŒ²å¤±æ•—æ™‚ã®å¯¾å¿œ
3. SAPå´ã¨ã®è²¬ä»»åˆ†ç•Œç‚¹

### 9-2. ğŸŸ  é«˜å„ªå…ˆï¼ˆé‹ç”¨ãƒ«ãƒ¼ãƒ«ï¼‰

#### åœ¨åº«ãƒ­ãƒƒã‚¯æ©Ÿèƒ½ã®ç”¨é€”

**ãƒ•ã‚¡ã‚¤ãƒ«**: `lot_models.py` (locked_quantity), `LockMode`

#### èª¿æ•´ç†ç”±ã®åˆ†é¡

**ãƒ•ã‚¡ã‚¤ãƒ«**: `adjustment_service.py`, `AdjustmentType`

### 9-3. ğŸŸ¡ ä¸­å„ªå…ˆï¼ˆæ‹¡å¼µæ€§ãƒ»å°†æ¥å¯¾å¿œï¼‰

#### ãƒãƒ«ãƒå€‰åº«å¯¾å¿œã®æ–¹é‡

**ãƒ•ã‚¡ã‚¤ãƒ«**: `config.py` (DEFAULT_WAREHOUSE_ID)

#### äºˆæ¸¬éœ€è¦ï¼ˆForecastï¼‰ã®æ´»ç”¨æ–¹æ³•

**ãƒ•ã‚¡ã‚¤ãƒ«**: `lot_reservations_model.py` (ReservationSourceType.FORECAST)

**å…ƒ:** `BUSINESS_CONTEXT_NEEDED.md` (2025-12-27)

---

## 10. Excelãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½ (ææ–™ãƒ­ãƒƒãƒˆç®¡ç†/å€‹åˆ¥)

### 10-1. åå®¹æ•°ãƒ»ä¿è¨¼æœŸé–“ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å®Ÿè£…

**å„ªå…ˆåº¦**: Low
**çŠ¶æ…‹**: å®Œäº†

**å†…å®¹**:
- ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã€Œåå®¹æ•°ã€ã€Œä¿è¨¼æœŸé–“ã€ãŒå¸¸ã« `-` è¡¨ç¤º
- `Product` ã« `capacity` / `warranty_period_days` ã‚’è¿½åŠ ã—ã€APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å«ã‚ã‚‹
  - å®Ÿè£…: `supplier_items` ã‚«ãƒ©ãƒ è¿½åŠ  â†’ `v_lot_receipt_stock` â†’ Inventory API â†’ Excel Viewãƒ˜ãƒƒãƒ€ãƒ¼åæ˜ 

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `frontend/src/features/inventory/components/excel-view/useExcelViewData.ts:177-178`
- `backend/app/presentation/schemas/inventory/inventory_schema.py`

---

### 10-2. å…ˆæ–¹å“ç•ªï¼ˆcustomerPartNoï¼‰ã®è¡¨ç¤º

**å„ªå…ˆåº¦**: Medium
**çŠ¶æ…‹**: å®Œäº†

**å†…å®¹**:
- å¾—æ„å…ˆæƒ…å ±ã®ã€Œå…ˆæ–¹å“ç•ªã€ãŒå¸¸ã« `-`
- `customer_items` ã‚’å‚ç…§ã—ã¦è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
  - å®Ÿè£…: `customer_items` ã‚’ `supplier_item_id` ã§å–å¾—ã—ã€å¾—æ„å…ˆIDã”ã¨ã®å…ˆæ–¹å“ç•ªã‚’ãƒãƒƒãƒ”ãƒ³ã‚°

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `frontend/src/features/inventory/components/excel-view/useExcelViewData.ts`
- `backend/app/presentation/api/v2/forecast/router.py`

---

### 10-3. ç™ºæ³¨NO.ã®è¡¨ç¤º

**å„ªå…ˆåº¦**: Low
**çŠ¶æ…‹**: å®Œäº†

**å†…å®¹**:
- ãƒ­ãƒƒãƒˆæƒ…å ±ã®ã€Œç™ºæ³¨NO.ã€ãŒå¸¸ã« `-`
- è¦ä»¶ç¢ºèªå¾Œã« `purchase_order_number` ç­‰ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ¤œè¨
  - å®Ÿè£…: `lot_receipts.order_no` ã‚’è¿½åŠ ã—ã€Excel Viewã§è¡¨ç¤º/æ›´æ–°

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `frontend/src/features/inventory/components/excel-view/useExcelViewData.ts`

---

### 10-4. æ—¥ä»˜åˆ—ã®ä»•æ§˜æ•´ç†ï¼ˆäºˆæ¸¬ vs å®Ÿç¸¾ï¼‰

**å„ªå…ˆåº¦**: High
**çŠ¶æ…‹**: è¦ä»¶ç¢ºèª

**å†…å®¹**:
- äºˆæ¸¬ï¼ˆãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆï¼‰ã¨å®Ÿç¸¾ï¼ˆå‡ºè·ç¢ºå®šï¼‰ã®æ‰±ã„æ–¹é‡ã‚’æ±ºå®š
- æ—¥ä»˜ãŒéããŸåˆ—ã®æ‰±ã„ï¼ˆè‡ªå‹•ç¢ºå®š/æ‰‹å‹•ç¢ºå®šï¼‰ã®æ•´ç†

---

### 10-5. åŒä¸€ãƒ­ãƒƒãƒˆç•ªå·ãƒ»å…¥è·æ—¥åˆ¥ã®è¡Œè¡¨ç¤ºç¢ºèª

**å„ªå…ˆåº¦**: Medium
**çŠ¶æ…‹**: å®Œäº†

**å†…å®¹**:
- åŒä¸€ãƒ­ãƒƒãƒˆç•ªå·ã§ã‚‚å…¥è·æ—¥é•ã„ã§åˆ¥è¡Œè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã®UIç¢ºèª
  - åˆ¶ç´„: åŒä¸€ãƒ­ãƒƒãƒˆç•ªå·ãƒ»åŒä¸€å…¥è·æ—¥ã¯ä¸å¯ï¼ˆåˆ†å‰²æ™‚ã¯å…¥è·æ—¥ã‚’ãšã‚‰ã™ï¼‰
  - ç´å…¥å…ˆã¯å…¨ãƒ­ãƒƒãƒˆã§åŒä¸€è¡Œæ§‹æˆï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«è¡¨ç¤ºï¼‰

---

### 10-6. ç´å…¥å…ˆ5ä»¶ä»¥ä¸‹ã®ç½«ç·šãƒã‚°

**å„ªå…ˆåº¦**: Medium
**çŠ¶æ…‹**: æœªå¯¾å¿œ

**å†…å®¹**:
- ShipmentTable / DateGrid ã®ç¸¦ç·šãŒæƒã‚ãªã„
- å¢ƒç•Œç·šã®é‡è¤‡ã‚’æ•´ç†ã—ã€ç¸¦ç·šã®æƒã„ã‚’æ”¹å–„
  - ç›®è¦–ç¢ºèªã®çµæœã€ç¾çŠ¶ã‚‚è§£æ¶ˆã›ãšã€‚æ™‚é–“å¯¾åŠ¹æœã‚’è€ƒæ…®ã—ãƒãƒƒã‚¯ãƒ­ã‚°ã«æ®‹ã™

---

### 10-7. ç´å…¥å…ˆè¿½åŠ ã®åæ˜ é…å»¶

**å„ªå…ˆåº¦**: Medium
**çŠ¶æ…‹**: å®Œäº†

**å†…å®¹**:
- ç´å…¥å…ˆè¿½åŠ å¾Œã®å†å–å¾—ã‚’å¼·åŒ–ã—ã€åæ˜ é…å»¶ãŒæ®‹ã‚‹ã‹å†ç¢ºèª

---

### 10-8. ã‚³ãƒ¡ãƒ³ãƒˆãƒ»æ‰‹å‹•å‡ºè·æ—¥ã®ä¿å­˜åæ˜ ç¢ºèª

**å„ªå…ˆåº¦**: Medium
**çŠ¶æ…‹**: å®Œäº†

**å†…å®¹**:
- æ•°é‡0ã§ã‚‚ã‚³ãƒ¡ãƒ³ãƒˆ/æ‰‹å‹•å‡ºè·æ—¥ãŒä¿å­˜ã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã€ä¿å­˜ â†’ å†èª­ã¿è¾¼ã¿ã§åæ˜ ã•ã‚Œã‚‹ã‹ç¢ºèª

---

### 10-9. ãƒ­ãƒƒãƒˆé‡è¤‡æ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

**å„ªå…ˆåº¦**: Medium
**çŠ¶æ…‹**: å®Œäº†

**å†…å®¹**:
- æ—¢å­˜ãƒ­ãƒƒãƒˆç•ªå·ä¿å­˜æ™‚ã®ãƒˆãƒ¼ã‚¹ãƒˆ/ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³è¡¨ç¤ºæ”¹å–„

---

### 10-10. ç´å…¥å…ˆè¡Œã®ä¸¦ã³æ›¿ãˆæ©Ÿèƒ½

**å„ªå…ˆåº¦**: Low
**çŠ¶æ…‹**: å®Œäº†

**å†…å®¹**:
- ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ä¸¦ã³æ›¿ãˆ + ä¿å­˜ï¼ˆlocalStorageï¼‰


---

## å‚è€ƒæƒ…å ±

### çµ±åˆå…ƒãƒ•ã‚¡ã‚¤ãƒ«

æœ¬ãƒãƒƒã‚¯ãƒ­ã‚°ã¯ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’çµ±åˆã—ãŸã‚‚ã®ã§ã™:

1. `docs/project/plans/backlog/TODO.md` (2026-01-10)
2. `docs/project/plans/backlog/backlog.md` (2026-01-18)
3. `docs/project/plans/backlog/BUSINESS_CONTEXT_NEEDED.md` (2025-12-27)
4. `docs/project/plans/backlog/FUTURE_IMPROVEMENTS.md` (æ—¥ä»˜ãªã—)
5. `docs/project/plans/backlog/MASTER_DATA_FIELD_ALIGNMENT_TASKS.md` (2026-01-19)
6. `docs/project/plans/backlog/any-type-reduction.md` (2026-01-18)
7. `docs/project/plans/backlog/next_reviews_ja.md` (æ—¥ä»˜ãªã—)
8. `docs/project/plans/backlog/smartread-cache-db-save-inconsistency.md` (2026-01-21)
9. `docs/project/plans/backlog/smartread-logging-gaps.md` (2026-01-21)

çµ±åˆå¾Œã®ãƒãƒƒã‚¯ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã¯ `docs/project/BACKLOG.md` ã«é…ç½®ã•ã‚Œã¦ã„ã¾ã™ã€‚
å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ `docs/archive/backlog/` ã«ä¿ç®¡ã•ã‚Œã¦ã„ã¾ã™ã€‚

---

### æ›´æ–°å±¥æ­´

- 2026-01-24: 9ãƒ•ã‚¡ã‚¤ãƒ«ã‚’çµ±åˆã—ã€å˜ä¸€ãƒãƒƒã‚¯ãƒ­ã‚°ã¨ã—ã¦æ•´ç†
- 2026-01-26: ã‚¯ã‚¤ãƒƒã‚¯ã‚¦ã‚£ãƒ³4ä»¶å¯¾å¿œ (1-4, 2-2, 2-4, 8-9)
- 2026-01-26: Excelãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½ã‚¿ã‚¹ã‚¯è¿½åŠ  (ã‚»ã‚¯ã‚·ãƒ§ãƒ³10)ã€ä»•å…¥å…ˆè¡¨ç¤ºãƒ»forecast_periodè¡¨ç¤ºä¿®æ­£å®Œäº†
- 2026-02-01: ãƒ­ãƒƒãƒˆã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æ™‚ã® 401 Unauthorized ã‚¨ãƒ©ãƒ¼ã®ä¿®æ­£ã€èªè¨¼ãƒ­ã‚¸ãƒƒã‚¯ã®çµ±åˆã‚’å®Œäº†
- 2026-02-02: E2Eãƒ†ã‚¹ãƒˆä¸¦åˆ—å®Ÿè¡Œã®å®‰å®šåŒ–å®Œäº†ã‚¿ã‚¹ã‚¯ã‚’ARCHIVE.mdã«ç§»å‹•ã€èªè¨¼ãƒ»èªå¯ã‚·ã‚¹ãƒ†ãƒ å†è¨­è¨ˆææ¡ˆã‚’è¿½åŠ 

---

## 11. æœªå®Œäº†ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ»è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«åŸºã¥ãã‚¿ã‚¹ã‚¯ (å„ªå…ˆåº¦: ä½ - å¾Œå›ã—)

æœ¬ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¿ã‚¹ã‚¯ã¯ã€è©³ç´°ãªè¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒå­˜åœ¨ã—ã¾ã™ãŒã€ç¾åœ¨ã¯ã€Œå¾Œå›ã—ã€ã¨ã—ã¦æ‰±ã„ã¾ã™ã€‚

### 11-1. é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ è¡¨ç¤ºæˆ¦ç•¥ã®é«˜åº¦åŒ– (Phase 1)
- **å†…å®¹**: `display_strategy` (immediate/deferred/persistent) ã«ã‚ˆã‚‹ãƒˆãƒ¼ã‚¹ãƒˆè¡¨ç¤ºã®å‡ºã—åˆ†ã‘ã€‚
- **å„ªå…ˆåº¦**: ä½ (å¾Œå›ã—)
- **é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: [PHASE1-4_IMPLEMENTATION_PLAN.md](file:///Users/kazuya/dev/projects/lot-management-system/docs/project/PHASE1-4_IMPLEMENTATION_PLAN.md)

### 11-2. å—æ³¨ç®¡ç†ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã¨OCRå–è¾¼ã®çµ±åˆ (Phase 2)
- **å†…å®¹**: å—æ³¨ç®¡ç†ãƒšãƒ¼ã‚¸ã¸ã®OCRå–è¾¼UIçµ±åˆã€3å±¤ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Œå…¨é©ç”¨ã€‚
- **å„ªå…ˆåº¦**: ä½ (å¾Œå›ã—)
- **é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: [PHASE1-4_IMPLEMENTATION_PLAN.md](file:///Users/kazuya/dev/projects/lot-management-system/docs/project/PHASE1-4_IMPLEMENTATION_PLAN.md)

### 11-3. ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®å®Œå…¨åˆ†å‰² (Phase 3)
- **å†…å®¹**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã€ãƒ­ã‚°ãƒ“ãƒ¥ãƒ¼ã‚¢ã€é€šçŸ¥è¨­å®šã®å®Œå…¨ãªç‹¬ç«‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼åŒ–ã¨UIæ•´ç†ã€‚
- **å„ªå…ˆåº¦**: ä½ (å¾Œå›ã—)
- **é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: [PHASE1-4_IMPLEMENTATION_PLAN.md](file:///Users/kazuya/dev/projects/lot-management-system/docs/project/PHASE1-4_IMPLEMENTATION_PLAN.md)

### 11-4. Excel View ä»˜éšæ©Ÿèƒ½ã®å°å…¥ (Phase 9)
- **å†…å®¹**: ãƒšãƒ¼ã‚¸ãƒ¬ãƒ™ãƒ«ãƒ¡ãƒ¢UIã€ã‚»ãƒ«åˆ¥ã‚³ãƒ¡ãƒ³ãƒˆç·¨é›†ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã€æ‰‹å‹•å‡ºè·æ—¥è¨­å®šæ©Ÿèƒ½ã®å®Ÿè£…ã€‚
- **å„ªå…ˆåº¦**: ä½ (å¾Œå›ã—)
- **é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: [PHASE9_NEXT_SESSION.md](file:///Users/kazuya/dev/projects/lot-management-system/docs/project/PHASE9_NEXT_SESSION.md)

### 11-5. å€‰åº«ã®è‡ªå‹•ç‰¹å®šæ©Ÿèƒ½ (Excel View é–¢é€£æ‹¡å¼µ)
- **å†…å®¹**: ã€Œå…ˆæ–¹å“ç•ªÃ—ãƒ¡ãƒ¼ã‚«ãƒ¼å“ç•ªÃ—ä»•å…¥å…ˆã€ã«ã‚ˆã‚‹å€‰åº«ã®è‡ªå‹•ç‰¹å®šãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè£…ã€‚
- **å„ªå…ˆåº¦**: ä½ (å¾Œå›ã—)
- **é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: [PHASE9_NEXT_SESSION.md](file:///Users/kazuya/dev/projects/lot-management-system/docs/project/PHASE9_NEXT_SESSION.md)

### 11-6. æ‹…å½“ä»•å…¥å…ˆãƒ•ã‚£ãƒ«ã‚¿ (`SupplierFilterSet`) ã®æ°´å¹³å±•é–‹
- **å†…å®¹**: åœ¨åº«ä¸€è¦§ã€å—æ³¨ä¸€è¦§ã€å…¥è·äºˆå®šä¸€è¦§ãªã©ã€å…¨ãƒšãƒ¼ã‚¸ã¸ã®å…±é€šãƒ•ã‚£ãƒ«ã‚¿ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®é©ç”¨ã€‚
- **å„ªå…ˆåº¦**: ä½ (å¾Œå›ã—)
- **é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: [supplier-filter-set-implementation-plan.md](file:///Users/kazuya/dev/projects/lot-management-system/docs/project/supplier-filter-set-implementation-plan.md)

---

---

## 4. å„ªå…ˆåº¦: ä½ï¼ˆå°†æ¥å¯¾å¿œãƒ»æŠ€è¡“çš„è² å‚µï¼‰

### 4-X. æ¥½è¦³çš„ãƒ­ãƒƒã‚¯ã®æ®‹ã‚Šãƒ†ãƒ¼ãƒ–ãƒ«å¯¾å¿œ

**å„ªå…ˆåº¦:** ä½ï¼ˆå®Ÿéš›ã«ç«¶åˆãŒç™ºç”Ÿã—ã¦ã‹ã‚‰å¯¾å¿œï¼‰
**ä½œæˆ:** 2026-02-05
**ã‚«ãƒ†ã‚´ãƒª:** æ’ä»–åˆ¶å¾¡ãƒ»ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§
**å·¥æ•°:** 1-2æ—¥

**èƒŒæ™¯:**
Phase 4ã§ SmartRead/OCRç³»ã¨ä¸»è¦ãƒã‚¹ã‚¿ç³»ã«æ¥½è¦³çš„ãƒ­ãƒƒã‚¯ (`version` ã‚«ãƒ©ãƒ ) ã‚’å°å…¥æ¸ˆã¿ã€‚æ®‹ã‚Šã®ä½é »åº¦æ›´æ–°ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã€å®Ÿéš›ã«ç«¶åˆãŒç™ºç”Ÿã—ãŸéš›ã«è¿½åŠ å¯¾å¿œã™ã‚‹ã€‚

**å®Ÿè£…æ¸ˆã¿ (18ãƒ†ãƒ¼ãƒ–ãƒ«):**
- SmartRead/OCRç³»: `smartread_tasks`, `smartread_wide_data`, `smartread_long_data`, `ocr_result_edits`
- ãƒã‚¹ã‚¿ç³»: `warehouses`, `suppliers`, `customers`, `delivery_places`, `makers`, `supplier_items`, `customer_items`, `product_mappings`, `product_uom_conversions`, `customer_item_jiku_mappings`, `customer_item_delivery_settings`, `warehouse_delivery_routes`, `shipping_master_raw`, `shipping_master_curated`
- å‰²å½“ç³»: `user_supplier_assignments`

**æœªå¯¾å¿œãƒ†ãƒ¼ãƒ–ãƒ«ã®é¸å®šåŸºæº–:**
ä»¥ä¸‹ã®æ¡ä»¶ã‚’**ã™ã¹ã¦æº€ãŸã™**ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å¯¾è±¡ã«ã€å®Ÿéš›ã«ç«¶åˆãŒç™ºç”Ÿã—ãŸã‚‰ `version` ã‚’è¿½åŠ :

1. **æ›´æ–°é »åº¦:** ä½é »åº¦ï¼ˆé€±1å›æœªæº€ï¼‰ã ãŒã€å°†æ¥çš„ã«è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç·¨é›†ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹
2. **ãƒ‡ãƒ¼ã‚¿é‡è¦åº¦:** ä¸Šæ›¸ãã•ã‚Œã‚‹ã¨æ¥­å‹™ã«å½±éŸ¿ãŒã‚ã‚‹
3. **ç¾çŠ¶ã®åˆ¶å¾¡:** æ¥½è¦³ãƒ­ãƒƒã‚¯ã‚‚æ‚²è¦³ãƒ­ãƒƒã‚¯ã‚‚ãªã„

**æœªå¯¾å¿œãƒ†ãƒ¼ãƒ–ãƒ«å€™è£œï¼ˆå„ªå…ˆé †ä½é †ï¼‰:**

#### Phase 3å€™è£œ (ç®¡ç†ç”»é¢ã®åŒæ™‚ç·¨é›†å¯¾ç­–)
ä»¥ä¸‹ã¯ç®¡ç†ç”»é¢ã§ç·¨é›†ã•ã‚Œã‚‹ãŒã€ç¾çŠ¶ã¯å˜ä¸€ç®¡ç†è€…ã®ã¿ã®ãŸã‚å„ªå…ˆåº¦ä½:
- `product_warehouse` - è£½å“å€‰åº«ãƒãƒƒãƒ”ãƒ³ã‚°
- `layer_code_mappings` - å±¤åˆ¥ã‚³ãƒ¼ãƒ‰ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆmakersã«çµ±åˆäºˆå®šï¼Ÿï¼‰
- `users`, `roles`, `user_roles` - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»æ¨©é™ç®¡ç†
- `system_configs` - ã‚·ã‚¹ãƒ†ãƒ è¨­å®š
- `holiday_calendars`, `company_calendars`, `original_delivery_calendars` - ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¨­å®š
- `missing_mapping_events` - ãƒãƒƒãƒ”ãƒ³ã‚°æ¬ æã‚¤ãƒ™ãƒ³ãƒˆ
- `sap_connections` - SAPæ¥ç¶šè¨­å®š
- `business_rules` - ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«

#### Phase 4å€™è£œ (äºˆæ¸¬/å…¥è·ç³»)
ãƒãƒƒãƒå‡¦ç†ãŒä¸»ã ãŒã€æ‰‹å‹•ç·¨é›†ã‚‚ã‚ã‚Šå¾—ã‚‹:
- `inbound_plans`, `inbound_plan_lines` - å…¥è·äºˆå®š
- `expected_lots` - äºˆå®šãƒ­ãƒƒãƒˆ

#### Phase 5å€™è£œ (å¼•å½“ç³» - æ¤œè¨)
ç¾åœ¨ã¯æ‚²è¦³ãƒ­ãƒƒã‚¯ (`FOR UPDATE`) ã§ä¿è­·ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€æ¥½è¦³ãƒ­ãƒƒã‚¯ã¯ä¸è¦ã®å¯èƒ½æ€§:
- `withdrawals`, `withdrawal_lines` - å‡ºåº«

#### å¯¾è±¡å¤–ï¼ˆè¿½è¨˜ã®ã¿ã€ã¾ãŸã¯ãƒãƒƒãƒå°‚ç”¨ï¼‰
ä»¥ä¸‹ã¯æ¥½è¦³ãƒ­ãƒƒã‚¯ä¸è¦:
- è¿½è¨˜ã®ã¿: `stock_history`, `allocation_traces`, `lot_reservation_history`, `forecast_history`, `rpa_run_events`, `rpa_run_item_attempts`, `rpa_run_fetches`, `sap_fetch_logs`, `system_client_logs`, `operation_logs`, `master_change_logs`, `server_logs`, `seed_snapshots`
- ãƒãƒƒãƒå°‚ç”¨: `forecast_current`, `material_order_forecasts`, `sap_material_cache`, `allocation_suggestions`
- ä½é »åº¦: `notifications` (æ—¢èª­æ›´æ–°ã®ã¿)

**å®Ÿè£…æ™‚ã®ä½œæ¥­:**
1. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ `version` ã‚«ãƒ©ãƒ è¿½åŠ 
2. ãƒ¢ãƒ‡ãƒ«ã« `version` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 
3. æ›´æ–°/å‰Šé™¤APIã§ `optimistic_lock.py` ãƒ˜ãƒ«ãƒ‘ãƒ¼ä½¿ç”¨
4. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ `version` ã‚’ä¿æŒãƒ»é€ä¿¡
5. 409ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¿½åŠ 

**é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ:**
- `docs/project/CONCURRENCY_CONTROL_AUDIT.md` - å…¨ãƒ†ãƒ¼ãƒ–ãƒ«èª¿æŸ»çµæœ
- `backend/app/application/services/common/optimistic_lock.py` - ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°

**å…ƒ:** Phase 4å®Ÿè£…å®Œäº†å¾Œã®æ®‹èª²é¡Œ (2026-02-05)

---
