# ヘルプページ: Markdown直レンダリング設計

**作成日:** 2026-02-07  
**優先度:** 低（実装は後続）  
**ステータス:** 設計完了 / 実装待ち

## 1. 背景と目的

- 仕様/使い方の一次情報を Markdown で管理し、そのままアプリ上で表示したい。
- ドキュメントの二重管理を避け、実装とヘルプの乖離を減らす。

## 2. 対象範囲

- 画面ごとのヘルプ導線（ヘッダ右上ボタン）
- ルートごとの Markdown 解決と表示
- 該当 Markdown 不在時の安全なフォールバック

非対象:
- ヘルプ全文検索
- 多言語切替
- CMS 連携

## 3. 採用方針

### 3.1 表示方式

- `TopNavLayout` に「ヘルプ」ボタンを配置し、クリックでモーダル表示。
- モーダル内をスクロール可能にし、長文でも閲覧可能にする。

### 3.2 Markdown 配置

- 配置先: `frontend/src/help/pages/`
- 例:
  - `frontend/src/help/pages/inventory.md`
  - `frontend/src/help/pages/inventory_excel_view.md`

### 3.3 ルート解決ルール

- ルートと Markdown の対応は「明示マップ + 最長一致」で解決する。
- 例:
  - `/inventory` -> `inventory.md`
  - `/inventory/excel-view/:productId` -> `inventory_excel_view.md`
- URL パラメータ部分は正規化してマッチ対象から除外する。

## 4. 実装設計

### 4.1 ローダー

- `import.meta.glob("/src/help/pages/*.md", { query: "?raw", import: "default" })` を使ってビルド時取り込み。
- ルート変更時に再解決し、対象 Markdown テキストを読み込む。

### 4.2 レンダラー

- `markdown-it` で HTML 化して表示（見出し/箇条書き/コードブロックを維持）。
- 外部リンクは `target="_blank" rel="noopener noreferrer"` を付与。
- 内部アンカー（`#heading`）は可能な範囲で有効化（必須ではない）。

### 4.3 フォールバック

- 該当 Markdown がない画面ではヘルプボタンを非表示（今回方針）。
- 読み込みエラー時はモーダル内で「ヘルプを読み込めませんでした」を表示し、アプリ本体は継続。

## 5. 受け入れ条件

1. 少なくとも2画面分の Markdown が追加され、各画面で正しい内容が開く。  
2. Markdown 不在画面でアプリは壊れず、ヘルプ導線は非表示。  
3. 見出し/箇条書き/コードブロックが崩れない。  
4. 長文がモーダル内スクロールで閲覧できる。  

## 6. テスト観点

- ルート遷移時のヘルプ切り替え
- Markdownあり/なし画面でのボタン表示有無
- エラー時フォールバック表示
- 外部リンクが新規タブで開くこと

## 7. 実装タスク（後続）

1. ヘルプモーダルコンポーネント追加  
2. ルート->Markdown解決ロジック追加  
3. Markdownファイル2件以上追加  
4. UIテスト（表示切替・フォールバック）追加  

## 8. 関連

- バックログ: `docs/project/BACKLOG.md` の「3-2. ヘルプページ: Markdown直レンダリング（設計済み）」  
