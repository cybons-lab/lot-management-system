# 次回以降のタスクリスト

**区分:** タスク  
**最終更新:** 記載なし

## 概要

このドキュメントは、在庫管理システムのUI改善における残課題と調査項目をまとめたものです。

## 対応状況

### 未対応

### 1. 在庫一覧ページネーションの「総件数」対応
- **現状**: APIが総件数（total count）を返さないため、フロントエンドでは「現在のページ番号」と「現在の表示件数」のみを表示しています（例: 「ページ 1 (表示件数: 20)」）。
- **課題**: ユーザーにとって全体のボリュームが把握しづらい状態です。
- **タスク**:
    - バックエンドAPI (`/api/v2/inventory/`) が総件数を返すように修正できるか調査する。
    - 修正可能な場合、APIレスポンスに `total` フィールドを追加し、フロントエンドのページネーションコンポーネントで総ページ数を計算・表示できるようにする。

### 2. アーカイブ済みデータの取得ロジック調査
- **現状**: ユーザーより「アーカイブ済みデータが正しく取得できていない気がする」との指摘があります。
- **タスク**:
    - `InventoryItemDetailPage` および `useLotsQuery` におけるアーカイブデータの取得ロジック（`status` パラメータの扱いなど）を詳細にレビューする。
    - 必要であれば、実際のAPIレスポンスとDBの状態を比較し、意図したデータが返却されているか検証する。

### 3. 在庫管理トップのフィルタ仕様の調査・改善
- **現状**: フィルタの挙動が直感的でないとの指摘があります。
    - 「製品」を選択した後に「仕入先」を変更すると、リストからデータが消える（AND検索がきつすぎる、または連動していない等）。
    - 倉庫フィルタが他と連動していない。
- **タスク**:
    - 現在のフィルタ実装（`useInventoryPageState` や `useFilterOptions`）の依存関係と絞り込みロジックを整理する。
    - ユーザーが期待する挙動（例: 選択可能な選択肢のみを表示する動的フィルタリング、あるいはOR検索の導入など）を明確にし、実装案を策定する。

### 4. 入庫登録画面（旧アドホック登録）のUI改善  
- **現状**:
    - フォームの項目順序が直感的でない（ロット番号→ロット種別→製品→仕入先... となっており、仕入先で製品を絞り込みたいフローと逆行している）。
    - 「仕入先」を選択しても「製品」は絞り込まれるが、「倉庫」は連動していない（現状のデータ構造上、仕入先-倉庫の紐付けがないため）。
    - 任意項目の「仕入単価」「販売単価」「税率」は不要。
- **タスク**:
    - **項目並び替え**: 基本情報の並び順を「ロット番号」→「仕入先（任意だが推奨）」→「ロット種別」→「製品」→「倉庫」の順に変更し、上から順に選択することで自然に絞り込まれるようにする。
    - **不要項目削除**: `AdhocLotFormFinancials` コンポーネントおよび関連するスキーマ定義から「仕入単価」「販売単価」「税率」を削除する。「備考」は残す。
    - **フィルタリング**: 仕入先選択時の製品絞り込みが正しく機能することを確認する（倉庫の絞り込みはデータ構造上今回は見送る）。
