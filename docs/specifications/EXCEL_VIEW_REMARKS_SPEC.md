# Excel View 付随機能 仕様書

## 1. ページ全体のメモ (Page-level Notes)
Excel Viewの画面最上部に表示される共通メモ機能。

- **表示位置**: 画面上部、製品情報の直下。「ページ全体のメモ」として折り畳み表示。
- **データ範囲**: メーカー品番 × 先方品番 × 納入先 の組み合わせごとにユニーク。
- **データ保存先**: `customer_item_delivery_settings.notes` (TEXT)
- **更新タイミング**: テキストエリアの `onBlur` （フォーカス外れ）時に自動保存。
- **仕様詳細**:
    - メモが存在する場合は「入力あり」というバッジが表示される。
    - 納入先の制約があるため、品番単体ではなく「誰に何を納めるか」という文脈で保持される。

## 2. セル別コメント (Cell-level Comments)
引当枚数（数量入力セル）ごとに個別に注釈を付ける機能。

- **操作方法**: 数量入力セルを右クリック → 「コメントを追加/編集」を選択。
- **インジケータ**: コメントが存在するセルには、右上に赤い三角形（Excelのコメントと同様の表現）が表示される。
- **データ保存先**: `allocation_suggestions.comment` (TEXT)
- **表示**: セルにマウスホバー（title属性）でも内容を確認可能。

## 3. 手動出荷日設定 (Manual Shipment Date)
本来の計算（納期 - リードタイム）とは別に、特定のロットに対して出荷日を個別に指定する機能。

- **操作方法**: 数量入力セルを右クリック → 「出荷日を設定/編集」を選択 → カレンダーから日付を選択。
- **表示**: 数量入力の下に「出荷: MM/dd」という形式で小さく表示される。
- **データ保存先**: `allocation_suggestions.manual_shipment_date` (DATE)
- **用途**: 早期出荷対応や、特定のロットだけ物理的な理由で出荷日がズレる場合に使用。

## 4. ロット備考 (Lot Remarks)
ロット情報の行（LotSection）ごとに表示される備考。

- **表示位置**: ロット番号や有効期限が並ぶ基本情報セクション。
- **データ保存先**: `lots.remarks` (TEXT)
- **更新タイミング**: ロット詳細編集ダイアログ、またはインプレース編集。
