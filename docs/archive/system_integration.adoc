= ã‚·ã‚¹ãƒ†ãƒ é€£æºä»•æ§˜
:toc: left
:toc-title: ç›®æ¬¡
:sectnums:

**æœ€çµ‚æ›´æ–°**: 2025-11-27

== æ¦‚è¦

æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€ãƒ­ãƒƒãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã¨å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ï¼ˆSAP ERPã€ãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ ç­‰ï¼‰ã¨ã®é€£æºä»•æ§˜ã‚’å®šç¾©ã™ã‚‹ã€‚

== ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

[mermaid]
....
%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#e3f2fd','primaryTextColor':'#1565c0','primaryBorderColor':'#1976d2','lineColor':'#424242','fontSize':'16px'}}}%%
graph TB
    subgraph ext ["å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ å±¤"]
        direction LR
        FC["ğŸ“Š ãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆ<br/>ã‚·ã‚¹ãƒ†ãƒ "]
        KB["ğŸ­ ã‹ã‚“ã°ã‚“<br/>ã‚·ã‚¹ãƒ†ãƒ "]
    end
    
    subgraph lms ["ãƒ­ãƒƒãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ "]
        direction TB
        FE["ğŸ–¥ï¸ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰<br/>(React + TypeScript)"]
        BE["âš™ï¸ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰<br/>(FastAPI + Python)"]
        DB[("ğŸ—„ï¸ PostgreSQL<br/>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹")]
        
        FE ---|REST API| BE
        BE ---|SQL| DB
    end
    
    subgraph erp ["åŸºå¹¹ã‚·ã‚¹ãƒ†ãƒ "]
        SAP["ğŸ’¼ SAP ERP"]
    end
    
    FC -.->|CSVãƒ•ã‚¡ã‚¤ãƒ«<br/>ã‚¤ãƒ³ãƒãƒ¼ãƒˆ| FE
    KB -.->|å—æ³¨ãƒ‡ãƒ¼ã‚¿| FE
    BE <-.->|REST API<br/>(å°†æ¥å®Ÿè£…)| SAP
    
    classDef extStyle fill:#e3f2fd,stroke:#1976d2,stroke-width:3px,color:#1565c0
    classDef lmsStyle fill:#f1f8e9,stroke:#558b2f,stroke-width:3px,color:#33691e
    classDef erpStyle fill:#fff3e0,stroke:#ef6c00,stroke-width:3px,color:#e65100
    
    class FC,KB extStyle
    class FE,BE,DB lmsStyle
    class SAP erpStyle
....

== æ¥­å‹™ãƒ•ãƒ­ãƒ¼

=== é€šå¸¸ãƒ•ãƒ­ãƒ¼ï¼ˆãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆã‚ã‚Šï¼‰

[mermaid]
....
%%{init: {'theme':'base', 'themeVariables': {'primaryColor':'#e8f5e9','primaryBorderColor':'#4caf50','tertiaryColor':'#fff9c4'}}}%%
flowchart LR
    A([ğŸ“¥ ãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆ<br/>å—ä¿¡]) --> B[ğŸ“Š ã‚¤ãƒ³ãƒãƒ¼ãƒˆ]
    B --> C[ğŸ“ˆ éœ€è¦äºˆæ¸¬ç™»éŒ²]
    C --> D[ğŸ“ ç™ºæ³¨å‡¦ç†]
    D --> E[ğŸ“¦ å…¥è·äºˆå®šç™»éŒ²]
    E --> F[âœ… å…¥è·å®Ÿç¸¾ç™»éŒ²]
    F --> G[ğŸ·ï¸ ãƒ­ãƒƒãƒˆåœ¨åº«ç”Ÿæˆ]
    G --> H[ğŸ“‹ å—æ³¨ç™»éŒ²]
    H --> I[ğŸ¯ åœ¨åº«å¼•å½“]
    I --> J[ğŸšš å‡ºè·å‡¦ç†]
    J --> K[ğŸ’¼ SAPå—æ³¨ç™»éŒ²]
    K --> L[ğŸ”„ å—æ³¨ç•ªå·<br/>æ›¸ãæˆ»ã—]
    L --> M([âœ… å®Œäº†])
    
    classDef startEnd fill:#c8e6c9,stroke:#2e7d32,stroke-width:2px
    classDef process fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef sap fill:#fff3e0,stroke:#ef6c00,stroke-width:3px
    
    class A,M startEnd
    class B,C,D,E,F,G,H,I,J process
    class K,L sap
....

=== ä¾‹å¤–ãƒ•ãƒ­ãƒ¼ï¼ˆã‹ã‚“ã°ã‚“æ–¹å¼ï¼‰

ãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆãŒãªã„å®šä¾‹å‡ºè·ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‚
éœ€è¦äºˆæ¸¬ã‚’è‡ªç¤¾ã§ç«‹ã¦ã‚‹ã‚±ãƒ¼ã‚¹ã€‚

[mermaid]
....
%%{init: {'theme':'base', 'themeVariables': {'primaryColor':'#fff9c4','primaryBorderColor':'#f57c00'}}}%%
flowchart LR
    A([ğŸ“¥ ã‹ã‚“ã°ã‚“æ³¨æ–‡<br/>å—ä¿¡]) --> B{ğŸ“Š ãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆ<br/>ç¢ºèª}
    B -->|ãªã—| C[ğŸ“ å—æ³¨ç™»éŒ²<br/>å®šä¾‹å‡ºè·]
    C --> D[ğŸ¯ åœ¨åº«å¼•å½“]
    D --> E[ğŸšš å‡ºè·å‡¦ç†]
    E --> F[ğŸ’¼ SAPå—æ³¨ç™»éŒ²]
    F --> G[ğŸ”„ å—æ³¨ç•ªå·<br/>æ›¸ãæˆ»ã—]
    G --> H[ğŸ“‹ å±¥æ­´ä¿å­˜]
    H --> I[ğŸ“Š ãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆ<br/>æ¶ˆåŒ–è¨˜éŒ²]
    I --> J([âœ… å®Œäº†])
    
    classDef startEnd fill:#fff9c4,stroke:#f57c00,stroke-width:2px
    classDef process fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef sap fill:#fff3e0,stroke:#ef6c00,stroke-width:3px
    classDef decision fill:#ffccbc,stroke:#d84315,stroke-width:2px
    
    class A,J startEnd
    class C,D,E,H,I process
    class F,G sap
    class B decision
....

== ã‚·ã‚¹ãƒ†ãƒ é–“é€£æºï¼ˆã‚·ãƒ¼ã‚±ãƒ³ã‚¹ï¼‰

[mermaid]
....
%%{init: {'theme':'base', 'themeVariables': {'actorBorder':'#1976d2','actorBkg':'#e3f2fd','signalColor':'#424242','labelBoxBkgColor':'#fff3e0'}}}%%
sequenceDiagram
    autonumber
    participant U as ğŸ‘¤ æ‹…å½“è€…
    participant L as ğŸ–¥ï¸ ãƒ­ãƒƒãƒˆç®¡ç†<br/>ã‚·ã‚¹ãƒ†ãƒ 
    participant S as ğŸ’¼ SAP ERP
    participant E as ğŸ“Š å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ 
    
    rect rgb(227, 242, 253)
        Note over U,E: ãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆå‡¦ç†
        E->>L: ãƒ•ã‚©ãƒ¼ã‚­ãƒ£ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«é€ä¿¡
        U->>L: ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ“ä½œ
        L->>L: éœ€è¦äºˆæ¸¬ãƒ‡ãƒ¼ã‚¿ç™»éŒ²
    end
    
    rect rgb(255, 243, 224)
        Note over U,L: ç™ºæ³¨ãƒ»å…¥è·
        U->>L: ç™ºæ³¨å‡¦ç†
        Note right of L: å°†æ¥çš„ã«SAPé€£æº
        U->>L: å…¥è·å®Ÿç¸¾ç™»éŒ²
        L->>L: ãƒ­ãƒƒãƒˆåœ¨åº«ç”Ÿæˆ
    end
    
    rect rgb(232, 245, 233)
        Note over U,S: å—æ³¨ãƒ»å¼•å½“ãƒ»å‡ºè·
        U->>L: å—æ³¨ç™»éŒ²
        L->>L: åœ¨åº«å¼•å½“å®Ÿè¡Œ
        U->>L: å‡ºè·æ‰¿èª
        L->>L: åœ¨åº«æ¸›ç®—
    end
    
    rect rgb(255, 249, 196)
        Note over L,S: SAPé€£æºï¼ˆé‡è¦ï¼‰
        L->>S: å—æ³¨ãƒ‡ãƒ¼ã‚¿é€ä¿¡
        S-->>L: å—æ³¨ç•ªå·è¿”å´
        L->>L: å—æ³¨ç•ªå·æ›¸ãæˆ»ã—
        L->>L: å±¥æ­´ä¿å­˜
    end
....

== SAP ERP é€£æºä»•æ§˜

=== é€£æºæ¦‚è¦

[cols="2,3,2,2", options="header"]
|===
| å‡¦ç† | ã‚¿ã‚¤ãƒŸãƒ³ã‚° | ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ | å®Ÿè£…çŠ¶æ³

| å—æ³¨ç™»éŒ²
| å‡ºè·æ‰¿èªå¾Œ
| LMS â†’ SAP
| âŒ æœªå®Ÿè£…

| å—æ³¨ç•ªå·å–å¾—
| SAPå—æ³¨ç™»éŒ²å¾Œ
| SAP â†’ LMS
| âŒ æœªå®Ÿè£…

| åœ¨åº«åŒæœŸ
| å®šæœŸãƒãƒƒãƒ
| SAP â‡„ LMS
| âŒ æœªå®Ÿè£…

| ç™ºæ³¨ãƒ‡ãƒ¼ã‚¿é€£æº
| ç™ºæ³¨å‡¦ç†æ™‚
| LMS â†’ SAP
| âŒ æœªå®Ÿè£…
|===

=== APIä»•æ§˜ï¼ˆäºˆå®šï¼‰

==== POST /api/sap/orders

å—æ³¨ãƒ‡ãƒ¼ã‚¿ã‚’SAP ERPã«ç™»éŒ²ã™ã‚‹ã€‚

*ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹:*
[source,json]
----
{
  "order_id": 123,
  "customer_code": "C001",
  "delivery_date": "2025-12-28",
  "items": [
    {
      "product_code": "PROD-001",
      "quantity": 100,
      "unit": "ML"
    }
  ]
}
----

*ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹:*
[source,json]
----
{
  "sap_order_number": "SAP-123-20251127",
  "status": "registered"
}
----

==== GET /api/sap/orders/{sap_order_number}

SAPå—æ³¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’å–å¾—ã™ã‚‹ã€‚

=== å®Ÿè£…çŠ¶æ³

ç¾åœ¨ã¯**ãƒ€ãƒŸãƒ¼å®Ÿè£…**ã€‚
å°†æ¥çš„ã«SAPæ¨™æº–APIã¾ãŸã¯RFCï¼ˆRemote Function Callï¼‰çµŒç”±ã§å®Ÿè£…äºˆå®šã€‚

== å®Ÿè£…è¨ˆç”»

=== ãƒ•ã‚§ãƒ¼ã‚º1: ãƒ€ãƒŸãƒ¼å®Ÿè£…ï¼ˆå®Œäº†äºˆå®š: 2026Q1ï¼‰

* [ ] SAPé€£æºAPIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¿½åŠ ï¼ˆãƒ€ãƒŸãƒ¼ï¼‰
* [ ] ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«SAPç™»éŒ²ãƒœã‚¿ãƒ³è¿½åŠ 
* [ ] ãƒ€ãƒŸãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¿”å´

=== ãƒ•ã‚§ãƒ¼ã‚º2: ä»•æ§˜ç¢ºå®šï¼ˆå®Œäº†äºˆå®š: 2026Q2ï¼‰

* [ ] SAPå´ã®é€£æºä»•æ§˜ç¢ºèª
* [ ] èªè¨¼æ–¹å¼ã®æ±ºå®šï¼ˆAPI Key / OAuth / RFCï¼‰
* [ ] ãƒ‡ãƒ¼ã‚¿ãƒãƒƒãƒ”ãƒ³ã‚°å®šç¾©

=== ãƒ•ã‚§ãƒ¼ã‚º3: æœ¬å®Ÿè£…ï¼ˆå®Œäº†äºˆå®š: 2026Q3-Q4ï¼‰

* [ ] SAP REST APIã¾ãŸã¯RFCæ¥ç¶šå®Ÿè£…
* [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹
* [ ] é€£æºãƒ­ã‚°ãƒ»ç›£è¦–æ©Ÿèƒ½

== é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

* link:architecture.adoc[ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£]
* link:schema.adoc[ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ]
* http://localhost:8000/api/docs[API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ï¼ˆSwagger UIï¼‰]
